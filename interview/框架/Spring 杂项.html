<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta property="og:url" content="https://newzone.top/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html"><meta property="og:site_name" content="nocetfy"><meta property="og:title" content="æ‚é¡¹"><meta property="og:description" content="æ‚é¡¹ [toc] static é™æ€æ–¹æ³•çš„ä½¿ç”¨ åœ¨åŒä¸€ä¸ª@Configurationé…ç½®ç±»å†…ï¼Œå¯¹staticå…³é”®å­—çš„ä½¿ç”¨åšå‡ºå¦‚ä¸‹è¯´æ˜ï¼Œä¾›ä»¥å‚è€ƒï¼š å¯¹äºæ™®é€šç±»å‹ï¼ˆéåç½®å¤„ç†å™¨ç±»å‹ï¼‰çš„@Beanæ–¹æ³•ï¼Œä½¿ç”¨staticå…³é”®å­—å¹¶ä¸èƒ½æ”¹å˜é¡ºåºï¼ˆæŒ‰ç…§æ–¹æ³•å®šä¹‰é¡ºåºæ‰§è¡Œï¼‰ï¼Œæ‰€ä»¥åˆ«æŒ‡æœ›å®ƒ staticå…³é”®å­—ä¸€èˆ¬æœ‰ä¸”ä»…ç”¨äº@Beanæ–¹æ³•è¿”å›ä¸ºBeanPostProcessorã€BeanFactoryPostProcessorç­‰ç±»å‹çš„æ–¹æ³•ï¼Œå¹¶ä¸”å»ºè®®æ­¤ç§æ–¹æ³•è¯·åŠ¡å¿…ä½¿ç”¨staticä¿®é¥°ï¼Œå¦åˆ™å®¹æ˜“å¯¼è‡´éšæ‚£ï¼ŒåŸ‹é›·ï¼Œè¿˜å¯ä»¥è§£é™¤Springçš„æ—¥å¿—è­¦å‘Š"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"æ‚é¡¹","image":[""],"dateModified":null,"author":[]}</script><title>æ‚é¡¹ | nocetfy</title><meta name="description" content="æ‚é¡¹ [toc] static é™æ€æ–¹æ³•çš„ä½¿ç”¨ åœ¨åŒä¸€ä¸ª@Configurationé…ç½®ç±»å†…ï¼Œå¯¹staticå…³é”®å­—çš„ä½¿ç”¨åšå‡ºå¦‚ä¸‹è¯´æ˜ï¼Œä¾›ä»¥å‚è€ƒï¼š å¯¹äºæ™®é€šç±»å‹ï¼ˆéåç½®å¤„ç†å™¨ç±»å‹ï¼‰çš„@Beanæ–¹æ³•ï¼Œä½¿ç”¨staticå…³é”®å­—å¹¶ä¸èƒ½æ”¹å˜é¡ºåºï¼ˆæŒ‰ç…§æ–¹æ³•å®šä¹‰é¡ºåºæ‰§è¡Œï¼‰ï¼Œæ‰€ä»¥åˆ«æŒ‡æœ›å®ƒ staticå…³é”®å­—ä¸€èˆ¬æœ‰ä¸”ä»…ç”¨äº@Beanæ–¹æ³•è¿”å›ä¸ºBeanPostProcessorã€BeanFactoryPostProcessorç­‰ç±»å‹çš„æ–¹æ³•ï¼Œå¹¶ä¸”å»ºè®®æ­¤ç§æ–¹æ³•è¯·åŠ¡å¿…ä½¿ç”¨staticä¿®é¥°ï¼Œå¦åˆ™å®¹æ˜“å¯¼è‡´éšæ‚£ï¼ŒåŸ‹é›·ï¼Œè¿˜å¯ä»¥è§£é™¤Springçš„æ—¥å¿—è­¦å‘Š">
    <meta name="keywords" content="è‡ªæˆ‘æå‡,æ•ˆç‡æå‡,å¼€æºå·¥å…·,å­¦ä¹ ç¬”è®°" />
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #252232;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/MyNotes/assets/style-fdc52a0b.css" as="style"><link rel="stylesheet" href="/MyNotes/assets/style-fdc52a0b.css">
    <link rel="modulepreload" href="/MyNotes/assets/app-59c87434.js"><link rel="modulepreload" href="/MyNotes/assets/framework-1ee2252c.js"><link rel="modulepreload" href="/MyNotes/assets/Spring æ‚é¡¹.html-b64ee977.js"><link rel="modulepreload" href="/MyNotes/assets/Spring æ‚é¡¹.html-b9180fac.js">

    <!-- çœ‹æ¿å¨˜åŒºå— -->
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-y/font-awesome/6.0.0/css/all.min.css" type="text/css" rel="stylesheet" />
    <script src="/live2d-widget/autoload.js"></script>
    <!-- End çœ‹æ¿å¨˜åŒºå— -->

    <!-- Matomo æ­¤åŒºå—ä¸ºç»Ÿè®¡ä»£ç ï¼Œè¯·åˆ é™¤-->
    <script>
      var _paq = window._paq = window._paq || [];
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="https://piwik.seoipo.com/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '7']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <!-- End Matomo Code æ­¤åŒºå—ä¸ºç»Ÿè®¡ä»£ç ï¼Œè¯·åˆ é™¤-->

  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/MyNotes/" class="brand"><img class="logo" src="/MyNotes/logo.svg" alt="nocetfy"><!----><span class="site-name hide-in-pad">nocetfy</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/MyNotes/blog" class="nav-link" aria-label="åšå®¢"><span class="font-icon icon iconfont icon-blog" style=""></span>åšå®¢<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ä»£ç "><span class="title"><span class="font-icon icon iconfont icon-code" style=""></span>ä»£ç </span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/MyNotes/code/Markdown" class="nav-link" aria-label="/code/Markdown"><!---->/code/Markdown<!----></a></li><li class="dropdown-item"><a href="/MyNotes/code/AutoHotkey" class="nav-link" aria-label="/code/AutoHotkey"><!---->/code/AutoHotkey<!----></a></li><li class="dropdown-item"><a href="/MyNotes/code/Electron" class="nav-link" aria-label="/code/Electron"><!---->/code/Electron<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>é¡µé¢å¼€å‘</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/MyNotes/web/VuePress" class="nav-link" aria-label="/web/VuePress"><!---->/web/VuePress<!----></a></li><li class="dropdown-subitem"><a href="/MyNotes/web/docsify" class="nav-link" aria-label="/web/docsify"><!---->/web/docsify<!----></a></li><li class="dropdown-subitem"><a href="/MyNotes/deploy/VPS" class="nav-link" aria-label="/deploy/VPS"><!---->/deploy/VPS<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="åº”ç”¨"><span class="title"><span class="font-icon icon iconfont icon-app" style=""></span>åº”ç”¨</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/MyNotes/apps/Applist" class="nav-link" aria-label="/apps/Applist"><!---->/apps/Applist<!----></a></li><li class="dropdown-item"><a href="/MyNotes/apps/ChatGPT" class="nav-link" aria-label="/apps/ChatGPT"><!---->/apps/ChatGPT<!----></a></li><li class="dropdown-item"><a href="/MyNotes/apps/livestreaming/1_obs_basic" class="nav-link" aria-label="ç›´æ’­æ‰‹å†Œ"><span class="font-icon icon iconfont icon-quote" style=""></span>ç›´æ’­æ‰‹å†Œ<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>æœåŠ¡/ç³»ç»Ÿ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/MyNotes/services/NAS" class="nav-link" aria-label="/services/NAS"><!---->/services/NAS<!----></a></li><li class="dropdown-subitem"><a href="/MyNotes/windows/faq" class="nav-link" aria-label="/windows/faq"><!---->/windows/faq<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç”Ÿæ´»"><span class="title"><span class="font-icon icon iconfont icon-emmet" style=""></span>ç”Ÿæ´»</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/MyNotes/family/Diet" class="nav-link" aria-label="/family/Diet"><!---->/family/Diet<!----></a></li><li class="dropdown-item"><a href="/MyNotes/family/Shoppinglist" class="nav-link" aria-label="/family/Shoppinglist"><!---->/family/Shoppinglist<!----></a></li><li class="dropdown-item"><a href="/MyNotes/family/Coupon" class="nav-link" aria-label="/family/Coupon"><!---->/family/Coupon<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="https://nav.newzone.top/" rel="noopener noreferrer" target="_blank" aria-label="å·¥å…·æ”¶è—" class="nav-link"><span class="font-icon icon iconfont icon-tool" style=""></span>å·¥å…·æ”¶è—<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><div class="nav-item"><a class="repo-link" href="https://github.com/nocetfy" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">ğŸ§° ç®—æ³•ç¬”è®°</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">ğŸš€ é¢è¯•ç¬”è®°</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">è®¡ç®—æœºåŸºç¡€</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">Java</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">MySQL</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">Redis</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">æ¶ˆæ¯é˜Ÿåˆ—</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">æ¡†æ¶</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20Cache.html" class="nav-link sidebar-link sidebar-page" aria-label="/interview/æ¡†æ¶/Spring Cache.md"><!---->/interview/æ¡†æ¶/Spring Cache.md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20AOP.html" class="nav-link sidebar-link sidebar-page" aria-label="AOP"><!---->AOP<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20Boot.html" class="nav-link sidebar-link sidebar-page" aria-label="Boot"><!---->Boot<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Dubbo.html" class="nav-link sidebar-link sidebar-page" aria-label="Dubbo"><!---->Dubbo<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20MVC.html" class="nav-link sidebar-link sidebar-page" aria-label="MVC"><!---->MVC<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Mybatis.html" class="nav-link sidebar-link sidebar-page" aria-label="Mybatis"><!---->Mybatis<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20IOC.html" class="nav-link sidebar-link sidebar-page" aria-label="Spring IOC"><!---->Spring IOC<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BB.html" class="nav-link sidebar-link sidebar-page" aria-label="å¸¸ç”¨å·¥å…·ç±»"><!---->å¸¸ç”¨å·¥å…·ç±»<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="æ‚é¡¹"><!---->æ‚é¡¹<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#static" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="static"><!---->static<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#é™æ€æ–¹æ³•çš„ä½¿ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é™æ€æ–¹æ³•çš„ä½¿ç”¨"><!---->é™æ€æ–¹æ³•çš„ä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#é™æ€å†…éƒ¨ç±»çš„ä½¿ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é™æ€å†…éƒ¨ç±»çš„ä½¿ç”¨"><!---->é™æ€å†…éƒ¨ç±»çš„ä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#é™æ€æ³¨å…¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é™æ€æ³¨å…¥"><!---->é™æ€æ³¨å…¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#èµ„æº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="èµ„æº"><!---->èµ„æº<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#resourceloader" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ResourceLoader"><!---->ResourceLoader<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#å±æ€§é…ç½®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å±æ€§é…ç½®"><!---->å±æ€§é…ç½®<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#propertysource" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="PropertySource"><!---->PropertySource<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#propertyresolver" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="PropertyResolver"><!---->PropertyResolver<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#environment" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Environment"><!---->Environment<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#value" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@Value"><!---->@Value<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#æ•°æ®è½¬æ¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®è½¬æ¢"><!---->æ•°æ®è½¬æ¢<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#propertyeditor" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="PropertyEditor"><!---->PropertyEditor<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#converterã€genericconverter" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Converterã€GenericConverter"><!---->Converterã€GenericConverter<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#conversionservice" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ConversionService"><!---->ConversionService<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#typeconvert" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="TypeConvert"><!---->TypeConvert<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#æ•°æ®ç»‘å®š" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®ç»‘å®š"><!---->æ•°æ®ç»‘å®š<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#propertyaccessor" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="PropertyAccessor"><!---->PropertyAccessor<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#beanwrapper" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="BeanWrapper"><!---->BeanWrapper<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#databinder" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="DataBinder"><!---->DataBinder<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#æ•°æ®æ ¡éªŒ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®æ ¡éªŒ"><!---->æ•°æ®æ ¡éªŒ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#å¸¸ç”¨æ³¨è§£" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¸¸ç”¨æ³¨è§£"><!---->å¸¸ç”¨æ³¨è§£<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#validatedå’Œ-validçš„åŒºåˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="@Validatedå’Œ@Validçš„åŒºåˆ«"><!---->@Validatedå’Œ@Validçš„åŒºåˆ«<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#åˆ†ç»„æ ¡éªŒ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ†ç»„æ ¡éªŒ"><!---->åˆ†ç»„æ ¡éªŒ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#spel" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpEL"><!---->SpEL<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">æ•°æ®ç»“æ„ä¸ç®—æ³•</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">ç½‘ç»œ</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">æ¶æ„</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">åˆ†å¸ƒå¼</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">è¿ç»´å¼€å‘</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ability" style=""></span><span class="title">å¼€æ”¾è®¾è®¡</span><span class="arrow right"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->æ‚é¡¹</h1><div class="page-info"><!----><!----><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 13574 å­—</span><meta property="wordCount" content="13574"></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 45 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT45M"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹<button class="print-button" title="print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#static" class="router-link-active router-link-exact-active toc-link level2">static</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#é™æ€æ–¹æ³•çš„ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level3">é™æ€æ–¹æ³•çš„ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#é™æ€å†…éƒ¨ç±»çš„ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level3">é™æ€å†…éƒ¨ç±»çš„ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#é™æ€æ³¨å…¥" class="router-link-active router-link-exact-active toc-link level3">é™æ€æ³¨å…¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#èµ„æº" class="router-link-active router-link-exact-active toc-link level2">èµ„æº</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#resourceloader" class="router-link-active router-link-exact-active toc-link level3">ResourceLoader</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#å±æ€§é…ç½®" class="router-link-active router-link-exact-active toc-link level2">å±æ€§é…ç½®</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#propertysource" class="router-link-active router-link-exact-active toc-link level3">PropertySource</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#propertyresolver" class="router-link-active router-link-exact-active toc-link level3">PropertyResolver</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#environment" class="router-link-active router-link-exact-active toc-link level3">Environment</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#value" class="router-link-active router-link-exact-active toc-link level3">@Value</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#æ•°æ®è½¬æ¢" class="router-link-active router-link-exact-active toc-link level2">æ•°æ®è½¬æ¢</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#propertyeditor" class="router-link-active router-link-exact-active toc-link level3">PropertyEditor</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#converterã€genericconverter" class="router-link-active router-link-exact-active toc-link level3">Converterã€GenericConverter</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#conversionservice" class="router-link-active router-link-exact-active toc-link level3">ConversionService</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#typeconvert" class="router-link-active router-link-exact-active toc-link level3">TypeConvert</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#æ•°æ®ç»‘å®š" class="router-link-active router-link-exact-active toc-link level2">æ•°æ®ç»‘å®š</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#propertyaccessor" class="router-link-active router-link-exact-active toc-link level3">PropertyAccessor</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#beanwrapper" class="router-link-active router-link-exact-active toc-link level3">BeanWrapper</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#databinder" class="router-link-active router-link-exact-active toc-link level3">DataBinder</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#æ•°æ®æ ¡éªŒ" class="router-link-active router-link-exact-active toc-link level2">æ•°æ®æ ¡éªŒ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#å¸¸ç”¨æ³¨è§£" class="router-link-active router-link-exact-active toc-link level3">å¸¸ç”¨æ³¨è§£</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#validatedå’Œ-validçš„åŒºåˆ«" class="router-link-active router-link-exact-active toc-link level3">@Validatedå’Œ@Validçš„åŒºåˆ«</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#åˆ†ç»„æ ¡éªŒ" class="router-link-active router-link-exact-active toc-link level3">åˆ†ç»„æ ¡éªŒ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/Spring%20%E6%9D%82%E9%A1%B9.html#spel" class="router-link-active router-link-exact-active toc-link level2">SpEL</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="æ‚é¡¹" tabindex="-1"><a class="header-anchor" href="#æ‚é¡¹" aria-hidden="true">#</a> æ‚é¡¹</h1><p>[toc]</p><h2 id="static" tabindex="-1"><a class="header-anchor" href="#static" aria-hidden="true">#</a> static</h2><h3 id="é™æ€æ–¹æ³•çš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#é™æ€æ–¹æ³•çš„ä½¿ç”¨" aria-hidden="true">#</a> é™æ€æ–¹æ³•çš„ä½¿ç”¨</h3><p>åœ¨åŒä¸€ä¸ª<code>@Configuration</code>é…ç½®ç±»å†…ï¼Œå¯¹staticå…³é”®å­—çš„ä½¿ç”¨åšå‡ºå¦‚ä¸‹è¯´æ˜ï¼Œä¾›ä»¥å‚è€ƒï¼š</p><ol><li>å¯¹äºæ™®é€šç±»å‹ï¼ˆéåç½®å¤„ç†å™¨ç±»å‹ï¼‰çš„@Beanæ–¹æ³•ï¼Œä½¿ç”¨staticå…³é”®å­—å¹¶ä¸èƒ½æ”¹å˜é¡ºåºï¼ˆæŒ‰ç…§æ–¹æ³•å®šä¹‰é¡ºåºæ‰§è¡Œï¼‰ï¼Œæ‰€ä»¥åˆ«æŒ‡æœ›å®ƒ</li><li>staticå…³é”®å­—ä¸€èˆ¬æœ‰ä¸”ä»…ç”¨äº@Beanæ–¹æ³•è¿”å›ä¸º<code>BeanPostProcessor</code>ã€<code>BeanFactoryPostProcessor</code>ç­‰ç±»å‹çš„æ–¹æ³•ï¼Œå¹¶ä¸”å»ºè®®æ­¤ç§æ–¹æ³•<strong>è¯·åŠ¡å¿…ä½¿ç”¨staticä¿®é¥°</strong>ï¼Œå¦åˆ™å®¹æ˜“å¯¼è‡´éšæ‚£ï¼ŒåŸ‹é›·ï¼Œè¿˜å¯ä»¥è§£é™¤Springçš„æ—¥å¿—è­¦å‘Š</li></ol><p>â€‹ staticå…³é”®å­—ä¸è¦æ»¥ç”¨ï¼ˆå…¶å®ä»»ä½•å…³é”®å­—çš†å‹¿ä¹±ç”¨ï¼‰ï¼Œåœ¨åŒä¸€é…ç½®ç±»å†…ï¼Œ<strong>ä¸å…¶è¯´å®ƒæ˜¯æå‡äº†Beançš„ä¼˜å…ˆçº§ï¼Œå€’ä¸å¦‚è¯´å®ƒè®©@Beanæ–¹æ³•é™æ€åŒ–ä»è€Œä¸å†éœ€è¦ä¾èµ–æ‰€åœ¨ç±»çš„å®ä¾‹å³å¯ç‹¬ç«‹è¿è¡Œ</strong>ã€‚</p><h3 id="é™æ€å†…éƒ¨ç±»çš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#é™æ€å†…éƒ¨ç±»çš„ä½¿ç”¨" aria-hidden="true">#</a> é™æ€å†…éƒ¨ç±»çš„ä½¿ç”¨</h3><ol><li><p>è·¨.javaæ–‡ä»¶</p><p>ï¼ˆè·¨é…ç½®ç±»ï¼‰ä¹‹é—´çš„é¡ºåºï¼Œæ˜¯ç”±è‡ªç„¶é¡ºåºæ¥ä¿è¯çš„ï¼ˆå­—æ¯è¡¨é¡ºåºï¼‰</p><p>å¦‚ï¼šå…ˆåŠ è½½Aæ‰“å¤´çš„é…ç½®ç±»ï¼ˆå«é™æ€å†…éƒ¨ç±»ï¼‰ï¼Œå†æ˜¯Oæ‰“å¤´çš„ï¼Œå†æ˜¯Zæ‰“å¤´çš„</p></li><li><p>åŒä¸€.javaæ–‡ä»¶å†…éƒ¨ï¼Œstaticé™æ€å†…éƒ¨ç±»ä¼˜å…ˆäºå¤–éƒ¨ç±»åˆå§‹åŒ–ã€‚è‹¥æœ‰å¤šä¸ªé™æ€å†…éƒ¨ç±»ï¼Œé‚£ä¹ˆæŒ‰ç…§ç±»åè‡ªç„¶æ’åºåˆå§‹åŒ–ï¼ˆå¹¶éæŒ‰ç…§å®šä¹‰é¡ºåºå“¦ï¼Œè¯·åŠ¡å¿…æ³¨æ„ï¼‰</p><p>è¯´æ˜ï¼šä¸€èˆ¬å†…éƒ¨ç±»åªå¯èƒ½ä¸å¤–éƒ¨ç±»â€œå‘ç”Ÿå…³ç³»â€ï¼Œä¸å…„å¼Ÿä¹‹é—´ä¸å»ºè®®æœ‰ä»»ä½•è”ç³»ï¼Œå¦åˆ™é¡ºåºæ§åˆ¶ä¸Šä½ å°±å¾—å½“å¿ƒäº†ã€‚æ¯•ç«Ÿé è‡ªç„¶é¡ºåºå»ä¿è¯æ˜¯ä¸€ç§å¼±ä¿è¯ï¼Œå®¹é”™æ€§å¤ªä½</p></li><li><p>åŒä¸€.javaæ–‡ä»¶å†…ï¼Œä¸åŒç±»å†…çš„@Beanæ–¹æ³•ä¹‹é—´çš„æ‰§è¡Œé¡ºåºï¼Œä¿æŒåŒ2ä¸€è‡´ï¼ˆä¹Ÿå°±è¯´ä½ çš„@Beanæ‰€åœ¨çš„@Configurationé…ç½®ç±»å…ˆåŠ è½½ï¼Œé‚£ä½ å°±ä¼˜å…ˆè¢«åˆå§‹åŒ–å–½ï¼‰</p><p>åŒä¸€Classå†…å¤šä¸ª@Beanæ–¹æ³•çš„æ‰§è¡Œé¡ºåºï¼Œä¼šæ ¹æ®å®šä¹‰é¡ºåºï¼Œç”±å­—èŠ‚ç é¡ºåºä¿è¯(åç½®å¤„ç†å™¨ç±»å‹é™¤å¤–ï¼‰ã€‚</p></li></ol><p>æ€»çš„æ¥è¯´ï¼Œå½“staticæ ‡æ³¨åœ¨classç±»ä¸Šæ—¶ï¼Œåœ¨<strong>åŒ.javaæ–‡ä»¶å†…</strong>å®ƒæ˜¯èƒ½å¤Ÿæå‡ä¼˜å…ˆçº§çš„ï¼Œè¿™å¯¹äº<code>Spring Boot</code>çš„è‡ªåŠ¨é…ç½®éå¸¸æœ‰æ„ä¹‰ï¼Œä¸»è¦ä½“ç°åœ¨å¦‚ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ul><li>staticé™æ€å†…éƒ¨ç±»é…ç½®ä¼˜å…ˆäºå¤–éƒ¨ç±»åŠ è½½ï¼Œä»è€Œé™æ€å†…éƒ¨ç±»é‡Œé¢çš„@Beanä¹Ÿ<strong>ä¼˜å…ˆäº</strong>å¤–éƒ¨ç±»çš„@Beanå…ˆåŠ è½½</li><li>æ—¢ç„¶è¿™æ ·ï¼Œé‚£ä¹ˆSpring Bootè‡ªåŠ¨é…ç½®å°±å¯ä»¥ç»“åˆæ­¤ç‰¹æ€§ï¼Œå°±å¯ä»¥è¿›è¡Œå…·æœ‰ä¼˜å…ˆçº§çš„<code>@Conditional</code>æ¡ä»¶åˆ¤æ–­äº†ã€‚è¿™é‡Œæˆ‘ä¸¾ä¸ªå®˜æ–¹çš„ä¾‹å­ï¼Œä½ ä¾¿èƒ½æ„Ÿå—åˆ°å®ƒçš„é­…åŠ›æ‰€åœ¨ï¼š</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FeignClientsConfiguration</span> <span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token annotation punctuation">@Bean</span>
	<span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span><span class="token string">&quot;prototype&quot;</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@ConditionalOnMissingBean</span>
	<span class="token keyword">public</span> <span class="token class-name">Feign<span class="token punctuation">.</span>Builder</span> <span class="token function">feignBuilder</span><span class="token punctuation">(</span><span class="token class-name">Retryer</span> retryer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token class-name">Feign</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">retryer</span><span class="token punctuation">(</span>retryer<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Configuration</span>
	<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">HystrixCommand</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">HystrixFeign</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">HystrixFeignConfiguration</span> <span class="token punctuation">{</span>
		<span class="token annotation punctuation">@Bean</span>
		<span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span><span class="token string">&quot;prototype&quot;</span><span class="token punctuation">)</span>
		<span class="token annotation punctuation">@ConditionalOnMissingBean</span>
		<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;feign.hystrix.enabled&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">public</span> <span class="token class-name">Feign<span class="token punctuation">.</span>Builder</span> <span class="token function">feignHystrixBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token class-name">HystrixFeign</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ å› ä¸º<code>HystrixFeign.builder()</code>å®ƒå±äºé™æ€å†…éƒ¨ç±»ï¼Œæ‰€ä»¥è¿™ä¸ª@Beanè‚¯å®šæ˜¯ä¼˜å…ˆäºå¤–éƒ¨çš„<code>Feign.builder()</code>å…ˆåŠ è½½çš„ã€‚æ‰€ä»¥è¿™æ®µé€»è¾‘å¯è§£é‡Šä¸ºï¼šä¼˜å…ˆä½¿ç”¨<code>HystrixFeign.builder()</code>ï¼ˆè‹¥æ¡ä»¶æ»¡è¶³ï¼‰ï¼Œå¦åˆ™ä½¿ç”¨<code>Feign.builder().retryer(retryer)</code>ä½œä¸ºå…œåº•ã€‚é€šè¿‡æ­¤ä¾‹ä½ åº”è¯¥å†ä¸€æ¬¡æ„Ÿå—åˆ°<strong>Beançš„åŠ è½½é¡ºåºä¹‹äºSpringåº”ç”¨çš„é‡è¦æ€§</strong>ï¼Œç‰¹åˆ«åœ¨Spring Boot/Cloudä¸‹æ­¤ç‰¹æ€§å°¤ä¸ºå‡¸æ˜¾ã€‚</p><h3 id="é™æ€æ³¨å…¥" tabindex="-1"><a class="header-anchor" href="#é™æ€æ³¨å…¥" aria-hidden="true">#</a> é™æ€æ³¨å…¥</h3><p>æ–¹å¼1</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserHelper</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token class-name">UCClient</span> ucClient<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUcClient</span><span class="token punctuation">(</span><span class="token class-name">UCClient</span> ucClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UserHelper</span><span class="token punctuation">.</span>ucClient <span class="token operator">=</span> ucClient<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–¹å¼2</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserHelper</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token class-name">UCClient</span> ucClient<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@PostConstruct</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UserHelper</span><span class="token punctuation">.</span>ucClient <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">UCClient</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–¹å¼3</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserHelper</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token class-name">UCClient</span> ucClient<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUcClient</span><span class="token punctuation">(</span><span class="token class-name">UCClient</span> ucClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UserHelper</span><span class="token punctuation">.</span>ucClient <span class="token operator">=</span> ucClient<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AutowireStaticSmartInitializingSingleton</span> <span class="token keyword">implements</span> <span class="token class-name">SmartInitializingSingleton</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AutowireCapableBeanFactory</span> beanFactory<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * å½“æ‰€æœ‰çš„å•ä¾‹Benaåˆå§‹åŒ–å®Œæˆåï¼Œå¯¹staticé™æ€æˆå‘˜è¿›è¡Œèµ‹å€¼
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterSingletonsInstantiated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å› ä¸ºæ˜¯ç»™staticé™æ€å±æ€§èµ‹å€¼ï¼Œå› æ­¤è¿™é‡Œnewä¸€ä¸ªå®ä¾‹åšæ³¨å…¥æ˜¯å¯è¡Œçš„</span>
        beanFactory<span class="token punctuation">.</span><span class="token function">autowireBean</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UserHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–¹å¼4</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserHelper</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token class-name">UCClient</span> ucClient<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUcClient</span><span class="token punctuation">(</span><span class="token class-name">UCClient</span> ucClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UserHelper</span><span class="token punctuation">.</span>ucClient <span class="token operator">=</span> ucClient<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AutowireStaticSmartInitializingSingleton</span> <span class="token keyword">implements</span> <span class="token class-name">SmartInitializingSingleton</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AutowiredAnnotationBeanPostProcessor</span> autowiredAnnotationBeanPostProcessor<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterSingletonsInstantiated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        autowiredAnnotationBeanPostProcessor<span class="token punctuation">.</span><span class="token function">processInjection</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UserHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3å’Œ4çš„å¥½å¤„ï¼š</p><ol><li>æ‰‹åŠ¨ç®¡ç†è¿™ç§caseçš„ä¾èµ–æ³¨å…¥ï¼Œæ›´å¯æ§ã€‚è€Œéäº¤ç»™Springå®¹å™¨å»è‡ªåŠ¨å¤„ç†</li><li>å·¥å…·ç±»<strong>æœ¬èº«</strong>å¹¶ä¸éœ€è¦åŠ å…¥åˆ°Springå®¹å™¨å†…ï¼Œè¿™å¯¹äºæœ‰å¤§é‡è¿™ç§caseçš„è¯ï¼Œæ˜¯å¯ä»¥èŠ‚çº¦å¼€é”€çš„</li></ol><hr><h2 id="èµ„æº" tabindex="-1"><a class="header-anchor" href="#èµ„æº" aria-hidden="true">#</a> èµ„æº</h2><p>èµ„æºç²—ç•¥çš„å¯ä»¥åˆ†ä¸ºï¼ˆè¿™é‡Œä»¥Springçš„åˆ†ç±»ä¸ºä¾‹ï¼‰ï¼š</p><ol><li>URLèµ„æº</li><li>Fileèµ„æº</li><li>ClassPathç›¸å…³èµ„æº</li><li>æœåŠ¡å™¨ç›¸å…³èµ„æºï¼ˆJBoss AS 5.xä¸Šçš„VFSèµ„æºï¼‰</li></ol><p>â€‹ JDKæ“çºµåº•å±‚èµ„æºåŸºæœ¬å°±æ˜¯<code>java.net.URL ã€java.io.File ã€java.util.Properties</code>è¿™äº›ï¼šå–èµ„æºåŸºæœ¬æ˜¯æ ¹æ®ç»å¯¹è·¯å¾„æˆ–å½“å‰ç±»çš„ç›¸å¯¹è·¯å¾„æ¥å–ã€‚ä»ç±»è·¯å¾„æˆ–Webå®¹å™¨ä¸Šä¸‹æ–‡ä¸­è·å–èµ„æºçš„æ—¶å€™ä¹Ÿä¸æ–¹ä¾¿ã€‚<strong>è‹¥ç›´æ¥ä½¿ç”¨è¿™äº›æ–¹æ³•ï¼Œéœ€è¦ç¼–å†™æ¯”è¾ƒå¤šçš„é¢å¤–ä»£ç ï¼Œä¾‹å¦‚å‰æœŸæ–‡ä»¶å­˜åœ¨åˆ¤æ–­ã€ç›¸å¯¹è·¯å¾„å˜ç»å¯¹è·¯å¾„ç­‰ã€‚</strong></p><p>è€ŒSpringæä¾›çš„<code>Resource</code>æ¥å£æä¾›äº†æ›´å¼ºå¤§çš„<strong>è®¿é—®åº•å±‚èµ„æºçš„èƒ½åŠ›</strong>ã€‚</p><p>Springä¸ºæˆ‘ä»¬æä¾›äº†éå¸¸å¤šçš„å®ç°ç±»ã€‚</p><ul><li>ByteArrayResource</li><li>InputStreamResource</li><li>FileSystemResource</li><li>UrlResource</li><li>ClassPathResource</li><li>ServletContextResource</li></ul><h3 id="resourceloader" tabindex="-1"><a class="header-anchor" href="#resourceloader" aria-hidden="true">#</a> ResourceLoader</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// @since 10.03.2004  å°ç»†èŠ‚ï¼šResourceæ¥å£æ˜¯@since 28.12.2003   æ‰€ä»¥è¿™ä¸ªæ¥å£æ™šäº†å¤§æ¦‚4ä¸ªæœˆçš„æ ·å­</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ResourceLoader</span> <span class="token punctuation">{</span>
	<span class="token comment">// å¸¸é‡ï¼šclasspath:</span>
	<span class="token comment">// å…¶å®ResourceLoaderæ¥å£åªæä¾›äº†classpathå‰ç¼€çš„æ”¯æŒã€‚è€Œclasspath*çš„å‰ç¼€æ”¯æŒæ˜¯åœ¨å®ƒçš„å­æ¥å£ResourcePatternResolverä¸­</span>
	<span class="token class-name">String</span> <span class="token constant">CLASSPATH_URL_PREFIX</span> <span class="token operator">=</span> <span class="token class-name">ResourceUtils</span><span class="token punctuation">.</span><span class="token constant">CLASSPATH_URL_PREFIX</span><span class="token punctuation">;</span>
	
	<span class="token comment">// è¿™ä¸ªæ–¹æ³•å¯è°“æ˜¯æ ¸å¿ƒæ–¹æ³•ï¼šè¿”å›Resourceå®ä¾‹</span>
	<span class="token comment">// å®ƒçš„ç›®çš„å¾ˆç®€å•ï¼šå°±æ˜¯å¸Œæœ›ç¨‹åºå‘˜åœ¨ä½¿ç”¨æ—¶ï¼Œä¸éœ€è¦å¤ªåœ¨æ„ä½¿ç”¨çš„æ˜¯å“ªä¸ªå®ä¾‹ã€‚é¢å‘æ¥å£æ“ä½œå³å¯</span>
	<span class="token comment">// è‡³äºé€‰å–å“ªä¸ªå®ä¾‹å»æ“ä½œï¼Œäº¤ç»™æ¡†æ¶æ¥å®Œæˆ</span>
	<span class="token class-name">Resource</span> <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token class-name">String</span> location<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">// Expose the ClassLoader used by this ResourceLoader.</span>
	<span class="token comment">// æš´éœ²å‡ºResourceLoaderä½¿ç”¨çš„ç±»åŠ è½½å™¨~~~</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token class-name">ClassLoader</span> <span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ ä»ä¸Šå¯ä»¥çœ‹å‡ºï¼šç¨‹åºå‘˜åœ¨ä½¿ç”¨Springå®¹å™¨æ—¶ï¼Œå¯ä»¥ä¸å»è¿‡äºè®¡è¾ƒåº•å±‚Resourceçš„å®ç°ï¼Œä¹Ÿä¸éœ€è¦è‡ªå·±åˆ›å»ºResourceå®ç°ç±»ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨<code>applicationContext.getResource()</code>ï¼Œè·å–åˆ°beanå®¹å™¨æœ¬èº«çš„Resourceï¼Œè¿›è€Œå–åˆ°ç›¸å…³çš„èµ„æºä¿¡æ¯ã€‚</p><figure><img src="https://raw.githubusercontent.com/nocetfy/image/main/img/image-20231029182235233.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// @since 10.03.2004</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultResourceLoader</span> <span class="token keyword">implements</span> <span class="token class-name">ResourceLoader</span> <span class="token punctuation">{</span>
	
	<span class="token comment">// è¿™é‡Œé¢classLoaderæ˜¯å…è®¸ä¸ºnullçš„</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">;</span>
	<span class="token comment">// è¿™ä¸ªç‰¹åˆ«é‡è¦ï¼šProtocolResolverè¿™ä¸ªæ¥å£äº‹Springä¸ºå¼€å‘è€…æä¾›äº†è‡ªå®šä¹‰æ‰©å±•æ¥å£ï¼ˆå…è®¸æˆ‘ä»¬è‡ªå·±å»ä»‹å…¥å‚ä¸åˆ°å…·ä½“çš„è·å–èµ„æºçš„å¤„ç†ä¸Šï¼Œåé¢getResouceæ–¹æ³•å¯è®®çœ‹å‡ºæ¥ï¼‰</span>
	<span class="token comment">// ProtocolResolveræ¥å£Springæ²¡æœ‰æä¾›ä»»ä½•å®ç°ï¼Œå¼€å‘è€…å¯è®®è‡ªå·±å®ç°ï¼Œä»è€Œå‚ä¸åˆ°èµ„æºè·å–çš„è·¯å­ä¸Šå»</span>
	<span class="token comment">// å¤‡æ³¨ï¼šè¿™ä¸ªæ¥å£@since 4.3  æ‰€ä»¥åªæœ‰Spring4.3åæ‰æœ‰è¿™ä¸ªèƒ½åŠ›å“¦~~~</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProtocolResolver</span><span class="token punctuation">&gt;</span></span> protocolResolvers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> resourceCaches <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// ClassLoaderå¯ä»¥ä¸æŒ‡å®šï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ä¹Ÿä¸éœ€è¦æŒ‡å®šï¼‰</span>
	<span class="token keyword">public</span> <span class="token class-name">DefaultResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>classLoader <span class="token operator">=</span> <span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">getDefaultClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token class-name">DefaultResourceLoader</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>classLoader <span class="token operator">=</span> classLoader<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// æˆ‘ä»¬å¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªProtocolResolver ï¼Œç„¶åå®ç°æˆ‘ä»¬è‡ªå·±çš„è·å–èµ„æºçš„é€»è¾‘~~~ä¸‹é¢ä¼šæœ‰ç¤ºä¾‹</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addProtocolResolver</span><span class="token punctuation">(</span><span class="token class-name">ProtocolResolver</span> resolver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>resolver<span class="token punctuation">,</span> <span class="token string">&quot;ProtocolResolver must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>protocolResolvers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>resolver<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// @since 5.0  å’ŒASMæœ‰å…³</span>
	<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">getResourceCache</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> valueType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourceCaches<span class="token punctuation">.</span><span class="token function">computeIfAbsent</span><span class="token punctuation">(</span>valueType<span class="token punctuation">,</span> key <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token comment">// è¿™ä¸ªæ˜¯æ ¸å¿ƒæ–¹æ³•~~~</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Resource</span> <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token class-name">String</span> location<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> <span class="token string">&quot;Location must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment">// é¦–å…ˆï¼ŒSpringä¼šçœ‹æˆ‘ä»¬è‡ªå·±æœ‰æ²¡æœ‰å®ç°è‡ªå·±çš„ProtocolResolver è‹¥æœ‰å®ç°ï¼Œä¼šå…ˆä»¥æˆ‘ä»¬è‡ªå·±çš„ä¸ºå‡†</span>
		<span class="token comment">// å¤‡æ³¨ï¼šå®ƒä¼šæŠŠResourceLoaderä¼ ç»™å¼€å‘è€…ï¼Œè¿™ç‚¹ç‰¹åˆ«é‡è¦~~~</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ProtocolResolver</span> protocolResolver <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>protocolResolvers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">Resource</span> resource <span class="token operator">=</span> protocolResolver<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>resource <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> resource<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// å¦‚æœä»¥/æ‰“å¤´ï¼Œå°±äº¤ç»™getResourceByPath()ï¼Œæ³¨æ„ï¼Œå®ƒæ˜¯ä¸€ä¸ªprotectedæ–¹æ³•ï¼Œå­ç±»æ˜¯å¯è®®å¤å†™çš„</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>location<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token function">getResourceByPath</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// å¦‚æœä»¥classpath:æ‰“å¤´ï¼Œæ¯«æ— ç–‘é—®ï¼Œäº¤ç»™ClassPathResource</span>
		<span class="token comment">// éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„å¿…é¡»`classpath:`  åŒºåˆ†å¤§å°å†™çš„å“¦</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>location<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token constant">CLASSPATH_URL_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token constant">CLASSPATH_URL_PREFIX</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// æœ€åçš„å¤„ç†æ–¹å¼ï¼šå°±æ˜¯å½“ä½œä¸€ä¸ªURLæ¥å¤„ç†</span>
		<span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">try</span> <span class="token punctuation">{</span>
				<span class="token comment">// Try to parse the location as a URL...</span>
				<span class="token comment">// å¦‚æœæ˜¯æ–‡ä»¶ç±»å‹ï¼Œäº¤ç»™FileUrlResourceï¼ˆ@since 5.0.2ï¼‰</span>
				<span class="token class-name">URL</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">ResourceUtils</span><span class="token punctuation">.</span><span class="token function">isFileURL</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">FileUrlResource</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">UrlResource</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">MalformedURLException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// No URL -&gt; resolve as resource path.</span>
				<span class="token comment">// fallback  ç›¸å½“äºè¿˜æ˜¯äº¤ç»™å­ç±»å»å¼„å§</span>
				<span class="token keyword">return</span> <span class="token function">getResourceByPath</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// å®ƒæ˜¯ä¸€ä¸ªprotectedæ–¹æ³•ï¼Œå¾ˆå¤šå­ç±»éƒ½æœ‰é‡å†™å®ƒã€‚å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤çš„å¤„ç†æ–¹å¼æ˜¯ï¼šå»classpthé‡ŒæŸ¥æ‰¾è¿™ä¸ªèµ„æº</span>
	<span class="token comment">// ClassPathContextResourceæ˜¯ä¸€ä¸ªprotectedå†…éƒ¨ç±»  extends ClassPathResource implements ContextResource</span>
	<span class="token keyword">protected</span> <span class="token class-name">Resource</span> <span class="token function">getResourceByPath</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathContextResource</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="resourcepatternresolver" tabindex="-1"><a class="header-anchor" href="#resourcepatternresolver" aria-hidden="true">#</a> ResourcePatternResolver</h4><p>â€‹ å®ƒä½¿ç”¨å¾—åè€Œæ›´åŠ çš„å¹¿æ³›ï¼Œä¹Ÿæ›´åŠ çš„å¼ºå¤§ã€‚ä»åå­—ä¸­å¯ä»¥çœ‹å‡ºï¼Œ<strong>å®ƒæ”¯æŒ</strong><code>Pattern</code><strong>ï¼Œæ”¯æŒæ­£åˆ™çš„æ¨¡å¼åŒ¹é…ï¼Œéå¸¸çš„å¼ºå¤§</strong>ï¼Œç”¨äºè§£æèµ„æºæ–‡ä»¶çš„<code>ç­–ç•¥æ¥å£</code>ï¼Œå…¶ç‰¹æ®Šçš„åœ°æ–¹åœ¨äºï¼Œå®ƒåº”è¯¥æä¾›å¸¦æœ‰<code>*</code>å·è¿™ç§é€šé…ç¬¦çš„èµ„æºè·¯å¾„ã€‚ æ­¤æ¥å£æ˜¯ResourceLoaderæ¥å£çš„æ‹“å±•æ¥å£ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// @since 1.0.2 æ˜¾ç„¶å®ƒå‡ºç°çš„æ—¶æœºæ™šäºResourceLoaderæ¥å£</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ResourcePatternResolver</span> <span class="token keyword">extends</span> <span class="token class-name">ResourceLoader</span> <span class="token punctuation">{</span>

	<span class="token comment">// ä¸ResourceLoaderä¸­classpathä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œæ­¤å‰ç¼€ä¼šåœ¨æ‰€æœ‰çš„JARåŒ…çš„æ ¹ç›®å½•ä¸‹æœç´¢æŒ‡å®šæ–‡ä»¶ã€‚  éå¸¸çš„å¼ºå¤§</span>
	<span class="token class-name">String</span> <span class="token constant">CLASSPATH_ALL_URL_PREFIX</span> <span class="token operator">=</span> <span class="token string">&quot;classpath*:&quot;</span><span class="token punctuation">;</span>
	<span class="token comment">// è¿”å›æŒ‡å®šè·¯å¾„ä¸‹æ‰€æœ‰çš„èµ„æºå¯¹è±¡ã€‚</span>
	<span class="token comment">// è¿”å›çš„å¯¹è±¡æ•°ç»„æœ‰Setçš„è¯­ä¹‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ`å¯¹äºåŒä¸€ä¸ªèµ„æºï¼Œåªè¿”å›ä¸€ä¸ªèµ„æºå¯¹è±¡`</span>
	<span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getResources</span><span class="token punctuation">(</span><span class="token class-name">String</span> locationPattern<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="pathmatchingresourcepatternresolver" tabindex="-1"><a class="header-anchor" href="#pathmatchingresourcepatternresolver" aria-hidden="true">#</a> PathMatchingResourcePatternResolver</h5><pre><code>å®ƒæ˜¯åŸºäº`æ¨¡å¼åŒ¹é…`çš„ï¼Œé»˜è®¤ä½¿ç”¨`org.springframework.util.AntPathMatcher`è¿›è¡Œè·¯å¾„åŒ¹é…ï¼Œå®ƒé™¤äº†æ”¯æŒ`ResourceLoader`æ”¯æŒçš„å‰ç¼€å¤–ï¼Œè¿˜é¢å¤–æ”¯æŒ`classpath*:`ç”¨äºåŠ è½½æ‰€æœ‰åŒ¹é…çš„ç±»è·¯å¾„`Resource`
</code></pre><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PathMatchingResourcePatternResolver</span> <span class="token keyword">implements</span> <span class="token class-name">ResourcePatternResolver</span> <span class="token punctuation">{</span>
	<span class="token comment">// å†…éƒ¨æŒæœ‰ä¸€ä¸ªresourceLoaderçš„å¼•ç”¨</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ResourceLoader</span> resourceLoader<span class="token punctuation">;</span>
	<span class="token comment">// æˆ‘ä»¬å‘ç°ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨æ˜¯AntPathMatcherè¿›è¡ŒåŒ¹é…çš„ï¼ˆSpringå†…éƒ¨AntPathMatcheræ˜¯PathMatcheræ¥å£çš„å”¯ä¸€å®ç°ã€‚</span>
	<span class="token comment">// å¦‚æœä½ æƒ³æ”¹å˜æ­¤åŒ¹é…è§„åˆ™ï¼Œä½ å¯ä»¥è‡ªå·±å®ç°ï¼ˆå½“ç„¶è¿™æ˜¯å®Œå…¨æ²¡å¿…è¦çš„ï¼‰ï¼‰</span>
	<span class="token keyword">private</span> <span class="token class-name">PathMatcher</span> pathMatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AntPathMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">// é»˜è®¤ä½¿ç”¨çš„DefaultResourceLoader  å½“ç„¶ä¹Ÿå¯ä»¥æŒ‡å®š</span>
	<span class="token keyword">public</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>resourceLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token class-name">ResourceLoader</span> resourceLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>resourceLoader<span class="token punctuation">,</span> <span class="token string">&quot;ResourceLoader must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>resourceLoader <span class="token operator">=</span> resourceLoader<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>resourceLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultResourceLoader</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	
	<span class="token comment">// æ˜¾ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®šè§£æå™¨ï¼Œé»˜è®¤ä½¿ç”¨AntPathMatcher</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPathMatcher</span><span class="token punctuation">(</span><span class="token class-name">PathMatcher</span> pathMatcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>pathMatcher<span class="token punctuation">,</span> <span class="token string">&quot;PathMatcher must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>pathMatcher <span class="token operator">=</span> pathMatcher<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// æœ€ç»ˆæ˜¯å§”æ‰˜ç»™ResourceLoaderå»åšäº†</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Resource</span> <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token class-name">String</span> location<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">getResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// è¿™ä¸ªæ˜¯æ ¸å¿ƒæ–¹æ³•~~~~~~~</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getResources</span><span class="token punctuation">(</span><span class="token class-name">String</span> locationPattern<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>locationPattern<span class="token punctuation">,</span> <span class="token string">&quot;Location pattern must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// ä»¥`classpath*:`æ‰“å¤´~~~</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>locationPattern<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token constant">CLASSPATH_ALL_URL_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// æŠŠå‰æœ€åé¢é‚£éƒ¨åˆ†æˆªå–å‡ºæ¥ï¼Œçœ‹çœ‹æ˜¯å¦æ˜¯æ¨¡ç‰ˆ(åŒ…å«*å’Œ?ç¬¦å·éƒ½å±äºæ¨¡ç‰ˆï¼Œå¦åˆ™ä¸æ˜¯)</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getPathMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isPattern</span><span class="token punctuation">(</span>locationPattern<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token constant">CLASSPATH_ALL_URL_PREFIX</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// a class path resource pattern</span>
				<span class="token comment">// æ˜¯patternï¼Œé‚£å°±äº¤ç»™è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ˜¯ä¸ªæ ¸å¿ƒæ–¹æ³•   è¿™é‡Œä¼ å…¥çš„æ˜¯locationPattern</span>
				<span class="token keyword">return</span> <span class="token function">findPathMatchingResources</span><span class="token punctuation">(</span>locationPattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token comment">// all class path resources with the given name</span>
				<span class="token comment">// å¦‚æœä¸æ˜¯patternï¼Œé‚£å°±å®Œå…¨åŒ¹é…ã€‚å»æ‰¾æ‰€æœ‰çš„pathä¸‹çš„åŒ¹é…ä¸Šçš„å°±æˆ~~~</span>
				<span class="token keyword">return</span> <span class="token function">findAllClassPathResources</span><span class="token punctuation">(</span>locationPattern<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token constant">CLASSPATH_ALL_URL_PREFIX</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// ä¸æ˜¯ä»¥`classpath*:`æ‰“å¤´çš„~~~~</span>
		<span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">// æ”¯æŒåˆ°tomcatçš„war:æ‰“å¤´çš„æ–¹å¼~~~</span>
			<span class="token keyword">int</span> prefixEnd <span class="token operator">=</span> <span class="token punctuation">(</span>locationPattern<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;war:&quot;</span><span class="token punctuation">)</span> <span class="token operator">?</span>  locationPattern<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;*/&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">:</span>
					locationPattern<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token char">&#39;:&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getPathMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isPattern</span><span class="token punctuation">(</span>locationPattern<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>prefixEnd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token function">findPathMatchingResources</span><span class="token punctuation">(</span>locationPattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token comment">// å¦‚æœå•¥éƒ½ä¸æ‰“å¤´ï¼Œé‚£å°±å½“ä½œä¸€ä¸ªæ­£å¸¸çš„å¤„ç†,å§”æ‰˜ç»™ResourceLoaderç›´æ¥å»å¤„ç†</span>
			<span class="token keyword">else</span> <span class="token punctuation">{</span>
				<span class="token comment">// a single resource with the given name</span>
				<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token function">getResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span>locationPattern<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// æ ¹æ®Patternå»åŒ¹é…èµ„æº~~~~</span>
	<span class="token keyword">protected</span> <span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">findPathMatchingResources</span><span class="token punctuation">(</span><span class="token class-name">String</span> locationPattern<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
		<span class="token comment">// å®šä½åˆ°è·Ÿæ–‡ä»¶å¤¹åœ°å€ã€‚æ¯”å¦‚locationPattern=classpath:META-INF/spring.factories  å¾—åˆ°classpath*:META-INF/</span>
		<span class="token comment">// è‹¥æ˜¯classpath*:META-INF/ABC/*.factories å¾—åˆ°çš„å°±æ˜¯ classpath*:META-INF/ABC/</span>
		<span class="token comment">// ç®€å•çš„è¯´ï¼Œå°±æ˜¯æˆªå–ç¬¬ä¸€ä¸ªä¸æ˜¯patternçš„åœ°æ–¹çš„å‰åŠéƒ¨åˆ†</span>
		<span class="token class-name">String</span> rootDirPath <span class="token operator">=</span> <span class="token function">determineRootDir</span><span class="token punctuation">(</span>locationPattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// ååŠéƒ¨åˆ†  è¿™é‡Œæ¯”å¦‚å°±æ˜¯ï¼š*.factories</span>
		<span class="token class-name">String</span> subPattern <span class="token operator">=</span> locationPattern<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>rootDirPath<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment">// è¿™ä¸ªé€’å½’å°±å‰å®³äº†ï¼Œç»§ç»­è°ƒç”¨äº†getResources(&quot;classpath*:META-INF/&quot;)æ–¹æ³•</span>
		<span class="token comment">// ç›¸å½“äºæŠŠè¯¥æ–‡ä»¶å¤¹åŒ¹é…çš„æ‰€æœ‰çš„èµ„æºï¼ˆæ³¨æ„ï¼šå¯èƒ½ä¼šæ¯”è¾ƒå¤šçš„ï¼‰ï¼Œæœ€ååœ¨å’ŒpatternåŒ¹é…å³å¯~~~~</span>
		<span class="token comment">// æ¯”å¦‚æ­¤å¤„ï¼šåªè¦jaré‡Œé¢æœ‰META-INFç›®å½•çš„  éƒ½ä¼šè¢«åŒ¹é…è¿›æ¥~~~~~~</span>
		<span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> rootDirResources <span class="token operator">=</span> <span class="token function">getResources</span><span class="token punctuation">(</span>rootDirPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Resource</span> rootDirResource <span class="token operator">:</span> rootDirResources<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// resolveRootDirResourceæ˜¯ç•™ç»™å­ç±»å»å¤å†™çš„ã€‚ä½†æ˜¯Springæ²¡æœ‰å­ç±»å¤å†™æ­¤æ–¹æ³•ï¼Œé»˜è®¤å®ç°æ˜¯å•¥éƒ½æ²¡åš~~~</span>
			rootDirResource <span class="token operator">=</span> <span class="token function">resolveRootDirResource</span><span class="token punctuation">(</span>rootDirResource<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">URL</span> rootDirUrl <span class="token operator">=</span> rootDirResource<span class="token punctuation">.</span><span class="token function">getURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			<span class="token comment">// è¿™ä¸ªifå°±ä¸€èˆ¬ä¸çœ‹äº†  æ˜¯å¦ä¸ºäº†åšå…¼å®¹~~~</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>equinoxResolveMethod <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> rootDirUrl<span class="token punctuation">.</span><span class="token function">getProtocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;bundle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token class-name">URL</span> resolvedUrl <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">)</span> <span class="token class-name">ReflectionUtils</span><span class="token punctuation">.</span><span class="token function">invokeMethod</span><span class="token punctuation">(</span>equinoxResolveMethod<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> rootDirUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>resolvedUrl <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					rootDirUrl <span class="token operator">=</span> resolvedUrl<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				rootDirResource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlResource</span><span class="token punctuation">(</span>rootDirUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>


			<span class="token comment">// æ”¯æŒvfsåè®®ï¼ˆJBoss)~~~</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>rootDirUrl<span class="token punctuation">.</span><span class="token function">getProtocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token class-name">ResourceUtils</span><span class="token punctuation">.</span><span class="token constant">URL_PROTOCOL_VFS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				result<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token class-name">VfsResourceMatchingDelegate</span><span class="token punctuation">.</span><span class="token function">findMatchingResources</span><span class="token punctuation">(</span>rootDirUrl<span class="token punctuation">,</span> subPattern<span class="token punctuation">,</span> <span class="token function">getPathMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		
			<span class="token comment">// æ˜¯å¦æ˜¯jaræ–‡ä»¶æˆ–è€…æ˜¯jarèµ„æº(æ˜¾ç„¶å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯æ­¤æƒ…å†µ~~~)</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ResourceUtils</span><span class="token punctuation">.</span><span class="token function">isJarURL</span><span class="token punctuation">(</span>rootDirUrl<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isJarResource</span><span class="token punctuation">(</span>rootDirResource<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// æŠŠrootDirUrl, subPatternéƒ½äº¤ç»™doFindPathMatchingJarResourceså»å¤„ç†</span>
				result<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token function">doFindPathMatchingJarResources</span><span class="token punctuation">(</span>rootDirResource<span class="token punctuation">,</span> rootDirUrl<span class="token punctuation">,</span> subPattern<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token comment">// ä¸æ˜¯Jaræ–‡ä»¶ï¼ˆé‚£å°±æ˜¯æœ¬å·¥ç¨‹é‡Œå­—çš„META-INFç›®å½•~~~ï¼‰</span>
			<span class="token comment">// é‚£å°±æ²¡å•¥å¥½è¯´çš„ï¼Œç›´æ¥ç»™ä¸ªsubPatternå»åŒ¹é…å§   æ³¨æ„è¿™ä¸ªæ–¹æ³•åæ˜¯Fileï¼Œä¸Šé¢æ˜¯jar</span>
			<span class="token keyword">else</span> <span class="token punctuation">{</span>
				result<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token function">doFindPathMatchingFileResources</span><span class="token punctuation">(</span>rootDirResource<span class="token punctuation">,</span> subPattern<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// æœ€ç»ˆè½¬æ¢ä¸ºæ•°ç»„è¿”å›ã€‚ æ³¨æ„æ­¤å¤„çš„resultæ˜¯ä¸ªsetï¼Œæ˜¯æœ‰å»é‡çš„æ•ˆæœçš„~~~</span>
		<span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">protected</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> <span class="token function">doFindPathMatchingJarResources</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> rootDirResource<span class="token punctuation">,</span> <span class="token class-name">URL</span> rootDirURL<span class="token punctuation">,</span> <span class="token class-name">String</span> subPattern<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">// è¿™ä¸ªæ–¹æ³•å°±æºç ä¸ç»†è¯´äº†ï¼Œ</span>
		<span class="token comment">// Find all resources in jar files that match the given location pattern</span>
		<span class="token comment">// å°±æ˜¯å»è¿™ä¸ªjaré‡Œé¢å»æ‰¾æ‰€æœ‰çš„èµ„æºï¼ˆé»˜è®¤åˆ©ç”¨Anté£æ ¼åŒ¹é…~ï¼‰</span>
		<span class="token comment">// æ­¤å¤„ç”¨åˆ°äº†`java.util.jar.JarFile`ã€`ZipFile`ã€`java.net.JarURLConnection`ç­‰ç­‰</span>
		<span class="token comment">// è·¯å¾„åŒ¹é…ï¼šgetPathMatcher().match(subPattern, relativePath) ä½¿ç”¨çš„æ­¤æ–¹æ³•å»æ ¡å¯¹</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Find all resources in the file system that match the given location pattern</span>
	<span class="token comment">// ç®€å•çš„è¯´ï¼Œè¿™ä¸ªå°±æ˜¯åœ¨æˆ‘ä»¬è‡ªå·±çš„é¡¹ç›®é‡Œæ‰¾~~~~</span>
	<span class="token keyword">protected</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> <span class="token function">doFindPathMatchingFileResources</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> rootDirResource<span class="token punctuation">,</span> <span class="token class-name">String</span> subPattern<span class="token punctuation">)</span>
			<span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

		<span class="token comment">// rootDir:æœ€ç»ˆæ˜¯ä¸ªç»å¯¹çš„è·¯å¾„åœ°å€ï¼Œå¸¦ç›˜ç¬¦çš„ã€‚æ¥ä»£è¡¨META-INFè¿™ä¸ªæ–‡ä»¶å¤¹~~~</span>
		<span class="token class-name">File</span> rootDir<span class="token punctuation">;</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			rootDir <span class="token operator">=</span> rootDirResource<span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsoluteFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// FileSystem  æœ€ç»ˆæ˜¯æ ¹æ®æ­¤ç»å¯¹è·¯å¾„ å»æ–‡ä»¶ç³»ç»Ÿé‡Œæ‰¾</span>
		<span class="token keyword">return</span> <span class="token function">doFindMatchingFileSystemResources</span><span class="token punctuation">(</span>rootDir<span class="token punctuation">,</span> subPattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼šå°±æ˜¯æŠŠè¯¥æ–‡ä»¶å¤¹æ‰€æœ‰çš„æ–‡ä»¶éƒ½æ‹¿å‡ºæ¥dir.listFiles()ï¼Œç„¶åä¸€ä¸ªä¸ªå»åŒ¹é…å‘—~~~~</span>
	<span class="token comment">// å¤‡æ³¨ï¼šå­ç±»`ServletContextResourcePatternResolver`å¤å†™äº†æ­¤æ–¹æ³•~~~~~</span>
	<span class="token keyword">protected</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> <span class="token function">doFindMatchingFileSystemResources</span><span class="token punctuation">(</span><span class="token class-name">File</span> rootDir<span class="token punctuation">,</span> <span class="token class-name">String</span> subPattern<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Looking for matching resources in directory tree [&quot;</span> <span class="token operator">+</span> rootDir<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">File</span><span class="token punctuation">&gt;</span></span> matchingFiles <span class="token operator">=</span> <span class="token function">retrieveMatchingFiles</span><span class="token punctuation">(</span>rootDir<span class="token punctuation">,</span> subPattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>matchingFiles<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">File</span> file <span class="token operator">:</span> matchingFiles<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">]</span>
			<span class="token comment">// æœ€ç»ˆç”¨FileSystemResourceæŠŠFileåŒ…è£…æˆä¸€ä¸ªResource~</span>
			result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> result<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="å±æ€§é…ç½®" tabindex="-1"><a class="header-anchor" href="#å±æ€§é…ç½®" aria-hidden="true">#</a> å±æ€§é…ç½®</h2><p>Springå±æ€§ç®¡ç†æ ¸å¿ƒAPIä¸»è¦åŒ…æ‹¬ä¸‹é¢4ä¸ªéƒ¨åˆ†ï¼š</p><ol><li><strong>PropertySource</strong>ï¼šå±æ€§æºã€‚key-valueå±æ€§å¯¹æŠ½è±¡</li><li><strong>PropertyResolver</strong>ï¼šå±æ€§è§£æå™¨ã€‚ç”¨äºè§£æç›¸åº”keyçš„value</li><li><strong>Profile</strong>ï¼šé…ç½®ï¼Œåªæœ‰æ¿€æ´»çš„é…ç½®profileçš„ç»„ä»¶/é…ç½®æ‰ä¼šæ³¨å†Œåˆ°Springå®¹å™¨ï¼Œç±»ä¼¼äºmavenä¸­profile</li><li><strong>Environment</strong>ï¼šç¯å¢ƒï¼Œæœ¬èº«ä¹Ÿæ˜¯ä¸ªå±æ€§è§£æå™¨<code>PropertyResolver</code>ã€‚å®ƒåœ¨åŸºç¡€ä¸Šè¿˜æä¾›äº†Profileç‰¹æ€§ï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„å¯¹å¤šç¯å¢ƒæ”¯æŒã€‚å› æ­¤æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨å®ƒï¼Œè€Œä¸æ˜¯åº•å±‚æ¥å£<code>PropertyResolver</code>ã€‚ å¯ä»¥ç®€å•ç²—æš´çš„æŠŠå®ƒç†è§£ä¸º<strong>Profile å’Œ PropertyResolver çš„ç»„åˆ</strong></li></ol><h3 id="propertysource" tabindex="-1"><a class="header-anchor" href="#propertysource" aria-hidden="true">#</a> PropertySource</h3><p><code>PropertySource</code>æ˜¯æŠ½è±¡ç±»ï¼Œ<strong>è¡¨ç¤ºä¸€ä¸ªé”®å€¼å¯¹</strong>ï¼Œä»£è¡¨ç€å±æ€§æºã€‚<code>Spring</code>å†…éƒ¨æ˜¯é€šè¿‡å®ƒæ¥æ‰¿è½½æ¥è‡ªä¸åŒåœ°æ–¹çš„å±æ€§æºçš„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// @since 3.1 </span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">PropertySource</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

	<span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span> <span class="token comment">// è¯¥å±æ€§æºçš„åå­—</span>
	<span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">T</span> source<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token class-name">PropertySource</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">T</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">&quot;Property source name must contain at least one character&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> <span class="token string">&quot;Property source must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>source <span class="token operator">=</span> source<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// è‹¥æ²¡æœ‰æŒ‡å®šsource é»˜è®¤å°±æ˜¯object  è€Œä¸æ˜¯null</span>
	<span class="token keyword">public</span> <span class="token class-name">PropertySource</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// getPropertyæ˜¯ä¸ªæŠ½è±¡æ–¹æ³•  å­ç±»å»å®ç°~~~</span>
	<span class="token comment">// å°ç»†èŠ‚ï¼šè‹¥å¯¹åº”çš„keyå­˜åœ¨ä½†æ˜¯å€¼ä¸ºnullï¼Œæ­¤å¤„ä¹Ÿæ˜¯è¿”å›falseçš„  è¡¨ç¤ºä¸åŒ…å«~</span>
	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">containsProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">getProperty</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">Object</span> <span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token comment">// æ­¤å¤„ç‰¹åˆ«ç‰¹åˆ«æ³¨æ„é‡å†™çš„è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å‘ç°å®ƒåªå’Œnameæœ‰å…³ï¼Œåªè¦nameç›¸ç­‰  å°±ä»£è¡¨ç€æ˜¯åŒä¸€ä¸ªå¯¹è±¡~~~~ è¿™ç‚¹ç‰¹åˆ«é‡è¦~</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> other <span class="token operator">||</span> <span class="token punctuation">(</span>other <span class="token keyword">instanceof</span> <span class="token class-name">PropertySource</span> <span class="token operator">&amp;&amp;</span>
				<span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">nullSafeEquals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PropertySource</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> other<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">nullSafeHashCode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	<span class="token comment">// é™æ€æ–¹æ³•ï¼šæ ¹æ®nameå°±åˆ›å»ºä¸€ä¸ªå±æ€§æº~  ComparisonPropertySourceæ˜¯StubPropertySourceçš„å­ç±»~</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PropertySource</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">named</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ComparisonPropertySource</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="propertyresolver" tabindex="-1"><a class="header-anchor" href="#propertyresolver" aria-hidden="true">#</a> PropertyResolver</h3><p>æ­¤æ¥å£ç”¨äºåœ¨<strong>åº•å±‚æº</strong>ä¹‹ä¸Šè§£æ<strong>ä¸€ç³»åˆ—</strong>çš„å±æ€§å€¼ï¼šä¾‹å¦‚propertiesæ–‡ä»¶,yamlæ–‡ä»¶,ç”šè‡³æ˜¯ä¸€äº›nosqlï¼ˆå› ä¸ºnosqlä¹Ÿæ˜¯k-vå½¢å¼ï¼‰ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// @since 3.1  å‡ºç°å¾—è¿˜æ˜¯ç›¸å¯¹è¾ƒæ™šçš„  æ¯•ç«ŸSpELä¹Ÿ3.0ä¹‹åæ‰å‡ºæ¥å˜›~~~</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PropertyResolver</span> <span class="token punctuation">{</span>

	<span class="token comment">// æŸ¥çœ‹è§„å®šæŒ‡å®šçš„keyæ˜¯å¦æœ‰å¯¹åº”çš„value   æ³¨æ„ï¼šè‹¥å¯¹åº”å€¼æ˜¯nullçš„è¯ ä¹Ÿæ˜¯è¿”å›false</span>
	<span class="token keyword">boolean</span> <span class="token function">containsProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// å¦‚æœæ²¡æœ‰åˆ™è¿”å›null</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token class-name">String</span> <span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// å¦‚æœæ²¡æœ‰åˆ™è¿”å›defaultValue</span>
	<span class="token class-name">String</span> <span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> defaultValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// è¿”å›æŒ‡å®škeyå¯¹åº”çš„valueï¼Œä¼šè§£ææˆæŒ‡å®šç±»å‹ã€‚å¦‚æœæ²¡æœ‰å¯¹åº”å€¼åˆ™è¿”å›nullï¼ˆè€Œä¸æ˜¯æŠ›é”™~ï¼‰</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> targetType<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> targetType<span class="token punctuation">,</span> <span class="token class-name">T</span> defaultValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// è‹¥ä¸å­˜åœ¨å°±ä¸æ˜¯è¿”å›nulläº†  è€Œæ˜¯æŠ›å‡ºå¼‚å¸¸~  æ‰€ä»¥ä¸ç”¨æ‹…å¿ƒè¿”å›å€¼æ˜¯null</span>
	<span class="token class-name">String</span> <span class="token function">getRequiredProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">;</span>
	<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">getRequiredProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> targetType<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">;</span>

	<span class="token comment">// è§£æ${...}è¿™ç§ç±»å‹çš„å ä½ç¬¦ï¼ŒæŠŠä»–ä»¬æ›¿æ¢ä¸ºä½¿ç”¨getPropertyæ–¹æ³•è¿”å›çš„ç»“æœï¼Œè§£æä¸äº†å¹¶ä¸”æ²¡æœ‰é»˜è®¤å€¼çš„å ä½ç¬¦ä¼šè¢«å¿½ç•¥ï¼ˆåŸæ ·è¾“å‡ºï¼‰</span>
	<span class="token class-name">String</span> <span class="token function">resolvePlaceholders</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// è§£æä¸äº†å°±æŠ›å‡ºå¼‚å¸¸~</span>
	<span class="token class-name">String</span> <span class="token function">resolveRequiredPlaceholders</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// @since 3.0  Utility class for working with Strings that have placeholder values in them</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PropertyPlaceholderHelper</span> <span class="token punctuation">{</span>

	<span class="token comment">// è¿™é‡Œä¿å­˜ç€  é€šç”¨çš„ç†Ÿæ‚‰çš„ å¼€é—­çš„ç¬¦å·ä»¬~~~</span>
	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> wellKnownSimplePrefixes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> <span class="token punctuation">{</span>
		wellKnownSimplePrefixes<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;{&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		wellKnownSimplePrefixes<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;[&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		wellKnownSimplePrefixes<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;)&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> placeholderPrefix<span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> placeholderSuffix<span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> simplePrefix<span class="token punctuation">;</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> valueSeparator<span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> ignoreUnresolvablePlaceholders<span class="token punctuation">;</span> <span class="token comment">// æ˜¯å¦é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼~~</span>

	<span class="token comment">// ä»propertiesé‡Œå–å€¼  è‹¥ä½ æœ‰å°±ç›´æ¥ä»Propertiesé‡Œå–å€¼äº†~~~</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">replacePlaceholders</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">Properties</span> properties<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>properties<span class="token punctuation">,</span> <span class="token string">&quot;&#39;properties&#39; must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token function">replacePlaceholders</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> properties<span class="token operator">::</span><span class="token function">getProperty</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// @since 4.3.5   æŠ½è±¡ç±»æä¾›è¿™ä¸ªç±»å‹è½¬æ¢çš„æ–¹æ³•~ éœ€è¦ç±»å‹è½¬æ¢çš„ä¼šè°ƒç”¨å®ƒ</span>
	<span class="token comment">// æ˜¾ç„¶å®ƒæ˜¯å§”æ‰˜ç»™äº†ConversionServiceï¼Œè€Œè¿™ä¸ªç±»åœ¨å‰é¢æ–‡ç« å·²ç»éƒ½é‡ç‚¹åˆ†æè¿‡äº†~</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">protected</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">convertValueIfNecessary</span><span class="token punctuation">(</span><span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> targetType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>targetType <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> value<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token class-name">ConversionService</span> conversionServiceToUse <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>conversionService<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>conversionServiceToUse <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// Avoid initialization of shared DefaultConversionService if</span>
			<span class="token comment">// no standard type conversion is needed in the first place...</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">isAssignableValue</span><span class="token punctuation">(</span>targetType<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> value<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			conversionServiceToUse <span class="token operator">=</span> <span class="token class-name">DefaultConversionService</span><span class="token punctuation">.</span><span class="token function">getSharedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> conversionServiceToUse<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> targetType<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// è¿™é‡Œä¼šä½¿ç”¨é€’å½’ï¼Œæ ¹æ®ä¼ å…¥çš„ç¬¦å·ï¼Œé»˜è®¤å€¼ç­‰æ¥å¤„ç†~~~~</span>
	<span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">parseStringValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token class-name">PlaceholderResolver</span> placeholderResolver<span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> visitedPlaceholders<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="environment" tabindex="-1"><a class="header-anchor" href="#environment" aria-hidden="true">#</a> Environment</h3><p>â€‹ è¿™ä¸ªæ¥å£ä»£è¡¨äº†å½“å‰åº”ç”¨æ­£åœ¨è¿è¡Œçš„ç¯å¢ƒï¼Œä¸ºåº”ç”¨çš„ä¸¤ä¸ªé‡è¦æ–¹é¢å»ºç«‹æŠ½è±¡æ¨¡å‹ ã€<code>profiles</code>ã€‘å’Œã€<code>properties</code>ã€‘ã€‚å…³äºå±æ€§è®¿é—®çš„æ–¹æ³•é€šè¿‡çˆ¶æ¥å£<code>PropertyResolver</code>æš´éœ²ç»™å®¢æˆ·ç«¯ä½¿ç”¨ï¼Œæœ¬æ¥å£ä¸»è¦æ˜¯æ‰©å±•å‡ºè®¿é—®ã€<code>profiles</code>ã€‘ç›¸å…³çš„æ¥å£ã€‚</p><p>å¯¹äºä»–ä¿©ï¼Œè¿™ä¹ˆæ¥ç¿»è¯‘ï¼š</p><ul><li><code>profiles</code>ï¼šé…ç½®ã€‚å®ƒä»£è¡¨åº”ç”¨åœ¨ä¸€å¯åŠ¨æ—¶æ³¨å†Œåˆ°contextä¸­bean definitionsçš„å‘½åçš„é€»è¾‘åˆ†ç»„ã€‚</li><li><code>properties</code>ï¼šå±æ€§ã€‚å‡ ä¹åœ¨æ‰€æœ‰åº”ç”¨ä¸­éƒ½æ‰®æ¼”ç€é‡è¦è§’è‰²ï¼Œä»–å¯èƒ½æºè‡ªå¤šç§æºå¤´ã€‚ä¾‹å¦‚å±æ€§æ–‡ä»¶ï¼ŒJVMç³»ç»Ÿå±æ€§ï¼Œç³»ç»Ÿç¯å¢ƒå˜é‡ï¼ŒJNDIï¼Œservletä¸Šä¸‹æ–‡å‚æ•°ï¼ŒMapç­‰ç­‰ï¼Œ<strong>Environmentå¯¹è±¡å’Œå…¶ç›¸å…³çš„å¯¹è±¡</strong>ä¸€èµ·æä¾›ç»™ç”¨æˆ·ä¸€ä¸ªæ–¹ä¾¿ç”¨æ¥é…ç½®å’Œè§£æå±æ€§çš„æœåŠ¡ã€‚</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// @since 3.1   å¯è§Spring3.xç‰ˆæœ¬æ˜¯Spirngä¸€æ¬¡æå…¶é‡è¦çš„è·¨è¶Šã€å‡çº§</span>
<span class="token comment">// å®ƒç»§æ‰¿è‡ªPropertyResolverï¼Œæ‰€ä»¥æ˜¯å¯¹å±æ€§çš„ä¸€ä¸ªæ‰©å±•~</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Environment</span> <span class="token keyword">extends</span> <span class="token class-name">PropertyResolver</span> <span class="token punctuation">{</span>
	
	<span class="token comment">// å°±ç®—è¢«æ¿€æ´»  ä¹Ÿæ˜¯æ”¯æŒåŒæ—¶æ¿€æ´»å¤šä¸ªprofilesçš„~</span>
	<span class="token comment">// è®¾ç½®çš„keyæ˜¯ï¼šspring.profiles.active</span>
	<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getActiveProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// é»˜è®¤çš„ä¹Ÿå¯ä»¥æœ‰å¤šä¸ª  keyä¸ºï¼šspring.profiles.default</span>
	<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getDefaultProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// çœ‹çœ‹ä¼ å…¥çš„profilesæ˜¯å¦æ˜¯æ¿€æ´»çš„~~~~  æ”¯æŒ!è¡¨ç¤ºä¸æ¿€æ´»</span>
	<span class="token annotation punctuation">@Deprecated</span>
	<span class="token keyword">boolean</span> <span class="token function">acceptsProfiles</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> profiles<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// Spring5.1åæä¾›çš„  ç”¨äºæ›¿ä»£ä¸Šé¢æ–¹æ³•   Profilesæ˜¯Spring5.1æ‰æœ‰çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£~</span>
	<span class="token keyword">boolean</span> <span class="token function">acceptsProfiles</span><span class="token punctuation">(</span><span class="token class-name">Profiles</span> profiles<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°æ¥å£<code>EnvironmentAware</code>æˆ–è€…ç›´æ¥<code>@Autowired</code>å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¾—åˆ°å½“å‰åº”ç”¨çš„ç¯å¢ƒï¼š<code>Environment</code>ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractEnvironment</span> <span class="token keyword">implements</span> <span class="token class-name">ConfigurableEnvironment</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">IGNORE_GETENV_PROPERTY_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;spring.getenv.ignore&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">ACTIVE_PROFILES_PROPERTY_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;spring.profiles.active&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DEFAULT_PROFILES_PROPERTY_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;spring.profiles.default&quot;</span><span class="token punctuation">;</span>

	<span class="token comment">// ä¿ç•™çš„é»˜è®¤çš„profileå€¼   protected finalå±æ€§ï¼Œè¯æ˜å­ç±»å¯ä»¥è®¿é—®</span>
	<span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">RESERVED_DEFAULT_PROFILE_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">;</span>


	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> activeProfiles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// æ˜¾ç„¶è¿™ä¸ªé‡Œé¢çš„å€¼ å°±æ˜¯defaultè¿™ä¸ªprofileäº†~~~~</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> defaultProfiles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token function">getReservedDefaultProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// è¿™ä¸ªå¾ˆå…³é”®ï¼Œç›´æ¥newäº†ä¸€ä¸ª MutablePropertySourcesæ¥ç®¡ç†å±æ€§æºä»¬</span>
	<span class="token comment">// å¹¶ä¸”æ˜¯ç”¨çš„PropertySourcesPropertyResolveræ¥å¤„ç†é‡Œé¢å¯èƒ½çš„å ä½ç¬¦~~~~~</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">MutablePropertySources</span> propertySources <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutablePropertySources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ConfigurablePropertyResolver</span> propertyResolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertySourcesPropertyResolver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>propertySources<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// å”¯ä¸€æ„é€ æ–¹æ³•  customizePropertySourcesæ˜¯ç©ºæ–¹æ³•ï¼Œäº¤ç”±å­ç±»å»å®ç°ï¼Œå¯¹å±æ€§æºè¿›è¡Œå®šåˆ¶~ </span>
	<span class="token comment">// Springå¯¹å±æ€§é…ç½®åˆ†å‡ºè¿™ä¹ˆå¤šæ›¾ç»ï¼Œåœ¨SpringBootä¸­æœ‰ç€æå…¶é‡è¦çš„æ„ä¹‰~~~~</span>
	<span class="token keyword">public</span> <span class="token class-name">AbstractEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">customizePropertySources</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>propertySources<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// è¯¥æ–¹æ³•ï¼ŒStandardEnvironmentå®ç°ç±»æ˜¯æœ‰å¤å†™çš„~</span>
	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">customizePropertySources</span><span class="token punctuation">(</span><span class="token class-name">MutablePropertySources</span> propertySources<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// è‹¥ä½ æƒ³æ”¹å˜é»˜è®¤defaultè¿™ä¸ªå€¼ï¼Œå¯ä»¥å¤å†™æ­¤æ–¹æ³•~~~~</span>
	<span class="token keyword">protected</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getReservedDefaultProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token constant">RESERVED_DEFAULT_PROFILE_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">//  ä¸‹é¢å¼€å§‹å®ç°æ¥å£çš„æ–¹æ³•ä»¬~~~~~~~</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getActiveProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">toStringArray</span><span class="token punctuation">(</span><span class="token function">doGetActiveProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">protected</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">doGetActiveProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>activeProfiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>activeProfiles<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
		
				<span class="token comment">// è‹¥ç›®å‰æ˜¯emptyçš„ï¼Œé‚£å°±å»è·å–ï¼šspring.profiles.active</span>
				<span class="token class-name">String</span> profiles <span class="token operator">=</span> <span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token constant">ACTIVE_PROFILES_PROPERTY_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>profiles<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">//æ”¯æŒ,åˆ†éš”è¡¨ç¤ºå¤šä¸ª~~~ä¸”ç©ºæ ¼å•¥çš„éƒ½æ— æ‰€è°“</span>
					<span class="token function">setActiveProfiles</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">commaDelimitedListToStringArray</span><span class="token punctuation">(</span>
							<span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">trimAllWhitespace</span><span class="token punctuation">(</span>profiles<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>activeProfiles<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>


	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setActiveProfiles</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> profiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>activeProfiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>activeProfiles<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å› ä¸ºæ˜¯setæ–¹æ³•  æ‰€ä»¥æƒ…å†µå·²å­˜åœ¨çš„å§</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> profile <span class="token operator">:</span> profiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				 <span class="token comment">// ç®€å•çš„validï¼Œä¸ä¸ºç©ºä¸”ä¸ä»¥!æ‰“å¤´~~~~~~~~</span>
				<span class="token function">validateProfile</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>activeProfiles<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// default profilesé€»è¾‘ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸èƒ½ä»¥!æ‰“å¤´~</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token annotation punctuation">@Deprecated</span>
	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">acceptsProfiles</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> profiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> profile <span class="token operator">:</span> profiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>

			<span class="token comment">// æ­¤å¤„ï¼šå¦‚æœè¯¥profileä»¥!å¼€å¤´ï¼Œé‚£å°±æˆªæ–­å‡ºæ¥  æŠŠååŠæ®µæ‹¿å‡ºæ¥çœ‹çœ‹   å®ƒæ˜¯å¦åœ¨activeè¡Œåˆ—é‡Œ~~~ </span>
			<span class="token comment">// æ­¤å¤„ç¨å¾®æ³¨æ„ï¼šè‹¥!è¡¨ç¤ºä¸€ä¸ªç›¸åçš„é€»è¾‘~~~~~è¯·æ³¨æ„æ¯”å¦‚!devè¡¨ç¤ºè‹¥devæ˜¯activeçš„ï¼Œæˆ‘åå€’æ˜¯ä¸ç”Ÿæ•ˆçš„</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> profile<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">&#39;!&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isProfileActive</span><span class="token punctuation">(</span>profile<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isProfileActive</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// é‡‡ç”¨å‡½æ•°å¼æ¥å£å¤„ç†  å°±éå¸¸çš„ä¼˜é›…äº†~</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">acceptsProfiles</span><span class="token punctuation">(</span><span class="token class-name">Profiles</span> profiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>profiles<span class="token punctuation">,</span> <span class="token string">&quot;Profiles must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> profiles<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">::</span><span class="token function">isProfileActive</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ç®€ç­”çš„è¯´è¦ä¹ˆactiveåŒ…å«ï¼Œè¦é—¨æ˜¯default  è¿™ä¸ªprofileå°±è¢«è®¤ä¸ºæ˜¯æ¿€æ´»çš„</span>
	<span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">isProfileActive</span><span class="token punctuation">(</span><span class="token class-name">String</span> profile<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">validateProfile</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> currentActiveProfiles <span class="token operator">=</span> <span class="token function">doGetActiveProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>currentActiveProfiles<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span> <span class="token operator">||</span>
				<span class="token punctuation">(</span>currentActiveProfiles<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">doGetDefaultProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">MutablePropertySources</span> <span class="token function">getPropertySources</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>propertySources<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSystemProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSystemEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// è¿™ä¸ªåˆ¤æ–­ä¸ºï¼šreturn SpringProperties.getFlag(IGNORE_GETENV_PROPERTY_NAME);</span>
		<span class="token comment">// æ‰€ä»¥æˆ‘ä»¬æ˜¯å¯ä»¥é€šè¿‡åœ¨`spring.properties`è¿™ä¸ªé…ç½®æ–‡ä»¶é‡Œspring.getenv.ignore=falseå…³æ‰ä¸æš´éœ²ç¯å¢ƒå˜é‡çš„~~~</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">suppressGetenvAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getenv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Append the given parent environment&#39;s active profiles, default profiles and property sources to this (child) environment&#39;s respective collections of each.</span>
	<span class="token comment">// æŠŠçˆ¶ç¯å¢ƒçš„å±æ€§åˆå¹¶è¿›æ¥~~~~  </span>
	<span class="token comment">// åœ¨è°ƒç”¨ApplicationContext.setParentæ–¹æ³•æ—¶ï¼Œä¼šæŠŠçˆ¶å®¹å™¨çš„ç¯å¢ƒåˆå¹¶è¿›æ¥  ä»¥ä¿è¯çˆ¶å®¹å™¨çš„å±æ€§å¯¹å­å®¹å™¨éƒ½æ˜¯å¯è§çš„</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableEnvironment</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PropertySource</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> ps <span class="token operator">:</span> parent<span class="token punctuation">.</span><span class="token function">getPropertySources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>propertySources<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>ps<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>propertySources<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// çˆ¶å®¹å™¨çš„å±æ€§éƒ½æ”¾åœ¨æœ€æœ«å°¾~~~~</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// åˆå¹¶active</span>
		<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parentActiveProfiles <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">getActiveProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>parentActiveProfiles<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>activeProfiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> profile <span class="token operator">:</span> parentActiveProfiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>activeProfiles<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// åˆå¹¶default</span>
		<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> parentDefaultProfiles <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">getDefaultProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>parentDefaultProfiles<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>defaultProfiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>defaultProfiles<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token constant">RESERVED_DEFAULT_PROFILE_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> profile <span class="token operator">:</span> parentDefaultProfiles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>defaultProfiles<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// å…¶ä½™æ–¹æ³•å…¨éƒ¨å§”æ‰˜ç»™å†…ç½®çš„propertyResolverå±æ€§ï¼Œå› ä¸ºå®ƒå°±æ˜¯ä¸ª`PropertyResolver`</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>webç›¸å…³é…ç½®çš„å±æ€§æºçš„ä¼˜å…ˆçº§æ˜¯é«˜äºsystemç›¸å…³çš„ã€‚è‹¥ä½¿ç”¨<code>@PropertySource</code>å¯¼å…¥è‡ªå®šä¹‰é…ç½®ï¼Œå®ƒä¼šä½äºæœ€åº•ç«¯ï¼ˆ<strong>ä¼˜å…ˆçº§æœ€ä½</strong>ï¼‰</p><h3 id="value" tabindex="-1"><a class="header-anchor" href="#value" aria-hidden="true">#</a> @Value</h3><p>æ”¯æŒåŠŸèƒ½ï¼š</p><ul><li>ç›´æ¥æ³¨å…¥å±æ€§</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>  <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;normal&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>æ³¨å…¥æ“ä½œç³»ç»Ÿå±æ€§</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	<span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${os.name}&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>æ³¨å…¥è¡¨è¾¾å¼ç»“æœ</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	<span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;#{ T(java.lang.Math).random() * 100.0 }&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>æ³¨å…¥å…¶ä»–Beançš„å±æ€§</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>  <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;#{person.name}&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>æ³¨å…¥æ–‡ä»¶èµ„æº</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>  <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:jdbc.properties&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>æ³¨å…¥URLèµ„æº</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>  <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Resource</span> testUrl<span class="token punctuation">;</span> <span class="token comment">// æ³¨å…¥URLèµ„æº</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="æ•°æ®è½¬æ¢" tabindex="-1"><a class="header-anchor" href="#æ•°æ®è½¬æ¢" aria-hidden="true">#</a> æ•°æ®è½¬æ¢</h2><figure><img src="https://raw.githubusercontent.com/nocetfy/image/main/img/uzc36vlf0q.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="propertyeditor" tabindex="-1"><a class="header-anchor" href="#propertyeditor" aria-hidden="true">#</a> PropertyEditor</h3><p>æ—©æœŸçš„Spirngï¼ˆ3.0ä¹‹å‰ï¼‰ç±»å‹è½¬æ¢æ˜¯åŸºäºJava Beansæ¥å£<code>java.beans.PropertyEditor</code>æ¥å®ç°çš„ï¼ˆå…¨éƒ¨ç»§æ‰¿è‡ª<code>PropertyEditorSupport</code>ï¼‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PropertyEditor</span> <span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token comment">// String -&gt; Object</span>
	<span class="token keyword">void</span> <span class="token function">setAsText</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>IllegalArgumentException</span><span class="token punctuation">;</span>
	<span class="token comment">// Object -&gt; String</span>
	<span class="token class-name">String</span> <span class="token function">getAsText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ç±»å®ç°ä¸¾ä¾‹æœ‰ï¼š</p><ul><li><code>StringArrayPropertyEditor</code>ï¼š<code>,</code>åˆ†éš”çš„å­—ç¬¦ä¸²å’Œ<code>String[]</code>ç±»å‹äº’è½¬</li><li><code>PropertiesEditor</code>ï¼šé”®å€¼å¯¹å­—ç¬¦ä¸²å’Œ<code>Properties</code>ç±»å‹äº’è½¬</li><li><code>IntegerEditor</code>ï¼šå­—ç¬¦ä¸²å’Œ<code>Integer</code>ç±»å‹äº’è½¬</li><li>...</li></ul><p>â€‹ åŸºäº<code>PropertyEditor</code>çš„ç±»å‹è½¬æ¢ä½œä¸ºä¸€ç§å¤è€çš„ã€é—ç•™ä¸‹æ¥çš„æ–¹å¼ï¼Œæ˜¯å…·æœ‰ä¸€äº›è®¾è®¡ç¼ºé™·çš„ï¼Œå¦‚ï¼šèŒè´£ä¸å•ä¸€ï¼Œç±»å‹ä¸å®‰å…¨ï¼Œåªèƒ½å®ç°<code>String</code>ç±»å‹çš„è½¬æ¢ç­‰ã€‚è™½ç„¶è‡ªSpring 3.0èµ·æä¾›äº†ç°ä»£åŒ–çš„ç±»å‹è½¬æ¢æ¥å£ï¼Œä½†æ˜¯æ­¤éƒ¨åˆ†æœºåˆ¶ä¸€ç›´å¾—ä»¥<strong>ä¿ç•™</strong>ï¼Œä¿è¯äº†å‘ä¸‹å…¼å®¹æ€§ã€‚</p><h3 id="converterã€genericconverter" tabindex="-1"><a class="header-anchor" href="#converterã€genericconverter" aria-hidden="true">#</a> Converterã€GenericConverter</h3><p>ä¸ºäº†è§£å†³<code>PropertyEditor</code>ä½œä¸ºç±»å‹è½¬æ¢æ–¹å¼çš„è®¾è®¡ç¼ºé™·ï¼ŒSpring 3.0ç‰ˆæœ¬é‡æ–°è®¾è®¡äº†ä¸€å¥—ç±»å‹è½¬æ¢æ¥å£ï¼Œå…¶ä¸­ä¸»è¦åŒ…æ‹¬ï¼š</p><h4 id="converter-s-t" tabindex="-1"><a class="header-anchor" href="#converter-s-t" aria-hidden="true">#</a> Converter&lt;S, T&gt;</h4><p>Source -&gt; Targetç±»å‹è½¬æ¢æ¥å£ï¼Œé€‚ç”¨äº1:1è½¬æ¢</p><ul><li><code>StringToPropertiesConverter</code>ï¼šå°†Stringç±»å‹è½¬æ¢ä¸ºProperties</li><li><code>StringToBooleanConverter</code>ï¼šå°†Stringç±»å‹è½¬æ¢ä¸ºBoolean</li><li><code>EnumToIntegerConverter</code>ï¼šå°†Enumç±»å‹è½¬æ¢ä¸ºInteger</li></ul><h4 id="converterfactory-s-r" tabindex="-1"><a class="header-anchor" href="#converterfactory-s-r" aria-hidden="true">#</a> ConverterFactory&lt;S, R&gt;</h4><p>Source -&gt; Rç±»å‹è½¬æ¢æ¥å£ï¼Œé€‚ç”¨äº1:Nè½¬æ¢</p><ul><li><code>StringToEnumConverterFactory</code>ï¼šå°†Stringç±»å‹è½¬ä»»æ„Enum</li><li><code>StringToNumberConverterFactory</code>ï¼šå°†Stringç±»å‹è½¬ä¸ºä»»æ„æ•°å­—ï¼ˆå¯ä»¥æ˜¯intã€longã€doubleç­‰ç­‰ï¼‰</li><li><code>NumberToNumberConverterFactory</code>ï¼šæ•°å­—ç±»å‹è½¬ä¸ºæ•°å­—ç±»å‹ï¼ˆå¦‚intåˆ°longï¼Œlongåˆ°doubleç­‰ç­‰ï¼‰</li></ul><h4 id="genericconverter" tabindex="-1"><a class="header-anchor" href="#genericconverter" aria-hidden="true">#</a> GenericConverter</h4><p>æ›´ä¸ºé€šç”¨çš„ç±»å‹è½¬æ¢æ¥å£ï¼Œé€‚ç”¨äºN:Nè½¬æ¢</p><ul><li><code>ObjectToCollectionConverter</code>ï¼šä»»æ„é›†åˆç±»å‹è½¬ä¸ºä»»æ„é›†åˆç±»å‹ï¼ˆå¦‚<code>List&lt;String&gt;</code>è½¬ä¸º<code>List&lt;Integer&gt; / Set&lt;Integer&gt;</code>éƒ½ä½¿ç”¨æ­¤è½¬æ¢å™¨</li><li><code>CollectionToArrayConverter</code>ï¼šè§£é‡ŠåŸºæœ¬åŒä¸Š</li><li><code>MapToMapConverter</code>ï¼šè§£é‡ŠåŸºæœ¬åŒä¸Š</li></ul><h4 id="conditionalconverter" tabindex="-1"><a class="header-anchor" href="#conditionalconverter" aria-hidden="true">#</a> ConditionalConverter</h4><p>æ¡ä»¶è½¬æ¢æ¥å£ã€‚å¯è·Ÿä¸Šé¢3ä¸ªæ¥å£ç»„åˆä½¿ç”¨ï¼Œæä¾›<strong>å‰ç½®æ¡ä»¶</strong>åˆ¤æ–­éªŒè¯ã€‚</p><p>â€‹ é‡æ–°è®¾è®¡çš„è¿™å¥—æ¥å£ï¼Œè§£å†³äº†<code>PropertyEditor</code>åšç±»å‹è½¬æ¢å­˜åœ¨çš„æ‰€æœ‰ç¼ºé™·ï¼Œä¸”å…·æœ‰éå¸¸é«˜çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªæ¥å£ç‹¬ç«‹æ¥çœ‹å‡å…·æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œåªæœ‰ä½¿ç”¨<strong>ç»„åˆæ‹³</strong>æ–¹æ‰æœ‰æœ€å¤§å¨åŠ›ã€‚</p><h3 id="conversionservice" tabindex="-1"><a class="header-anchor" href="#conversionservice" aria-hidden="true">#</a> ConversionService</h3><p>â€‹ æ–°çš„è¿™å¥—æ¥å£ä¸­ï¼Œ<code>Converterã€ConverterFactoryã€GenericConverter</code>å®ƒä»¬ä¸‰éƒ½ç€åŠ›äºå®Œæˆç±»å‹è½¬æ¢ã€‚å¯¹äºä½¿ç”¨è€…è€Œè¨€ï¼Œå¦‚æœåšä¸ªç±»å‹è½¬æ¢éœ€è¦äº†è§£åˆ°è¿™ä¸‰å¥—ä½“ç³»æ— ç–‘æˆæœ¬å¤ªé«˜ï¼Œå› æ­¤å°±æœ‰äº†<code>ConversionService</code>ç”¨äºæ•´åˆå®ƒä»¬ä¸‰ï¼Œç»Ÿä¸€åŒ–æ¥å£æ“ä½œã€‚</p><p>æ­¤æ¥å£ä¹Ÿæ˜¯Spring 3.0æ–°å¢ï¼Œç”¨äº<strong>ç»Ÿä¸€åŒ–</strong> åº•å±‚ç±»å‹è½¬æ¢å®ç°çš„å·®å¼‚ï¼Œå¯¹å¤–æä¾›ç»Ÿä¸€æœåŠ¡ï¼Œæ‰€ä»¥å®ƒä¹Ÿè¢«ç§°ä½œç±»å‹è½¬æ¢çš„<strong>é—¨é¢æ¥å£</strong>ï¼Œä»æ¥å£åç§°<code>xxxService</code>ä¹Ÿèƒ½çœ‹å‡ºæ¥å…¶è®¾è®¡æ€è·¯ã€‚å®ƒä¸»è¦æœ‰ä¸¤å¤§å®ç°ï¼š</p><ol><li><code>GenericConversionService</code>ï¼šæä¾›æ¨¡ç‰ˆå®ç°ï¼Œå¦‚è½¬æ¢å™¨çš„æ³¨å†Œã€åˆ é™¤ã€åŒ¹é…æŸ¥æ‰¾ç­‰ï¼Œä½†å¹¶ä¸å†…ç½®è½¬æ¢å™¨å®ç°</li><li><code>DefaultConversionService</code>ï¼šç»§æ‰¿è‡ªGenericConversionServiceã€‚åœ¨å®ƒåŸºç¡€ä¸Šé»˜è®¤æ³¨å†Œäº†éå¸¸å¤šçš„å†…å»ºçš„è½¬æ¢å™¨å®ç°ï¼Œä»è€Œèƒ½å¤Ÿå®ç°<strong>ç»å¤§éƒ¨åˆ†</strong>çš„ç±»å‹è½¬æ¢éœ€æ±‚</li></ol><p>â€‹ <code>ConversionService</code>è½¬æ¢æœåŠ¡å®ƒè´¯ç©¿äºSpringä¸Šä¸‹æ–‡<code>ApplicationContext</code>çš„å¤šé¡¹åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼šBeanWrapperå¤„ç†Beanå±æ€§ã€DataBinderæ•°æ®ç»‘å®šã€PropertySourceå¤–éƒ¨åŒ–å±æ€§å¤„ç†ç­‰ç­‰ã€‚</p><h3 id="typeconvert" tabindex="-1"><a class="header-anchor" href="#typeconvert" aria-hidden="true">#</a> TypeConvert</h3><p>â€‹ å®šä¹‰ç±»å‹è½¬æ¢æ–¹æ³•çš„æ¥å£ï¼Œå®ƒåœ¨Spring 2.0å°±å·²ç»å­˜åœ¨ã€‚åœ¨è¿˜æ²¡æœ‰<code>ConversionService</code>ä¹‹å‰ï¼Œå®ƒçš„ç±»å‹è½¬æ¢åŠ¨ä½œå‡å§”æ‰˜ç»™å·²æ³¨å†Œçš„<code>PropertyEditor</code>æ¥å®Œæˆã€‚ä½†è‡ª3.0ä¹‹åï¼Œè¿™ä¸ªè½¬æ¢åŠ¨ä½œå¯èƒ½è¢«PropertyEditoræ¥åšï¼Œä¹Ÿå¯èƒ½äº¤ç»™<code>ConversionService</code>å¤„ç†ã€‚</p><p>å®ƒä¸€å…±æä¾›ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// @since 2.0</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">TypeConverter</span> <span class="token punctuation">{</span>

 	<span class="token comment">// valueï¼šå¾…è½¬æ¢çš„sourceæºæ•°æ®</span>
 	<span class="token comment">// requiredTypeï¼šç›®æ ‡ç±»å‹targetType</span>
 	<span class="token comment">// methodParamï¼šè½¬æ¢çš„ç›®æ ‡æ–¹æ³•å‚æ•°ï¼Œä¸»è¦ä¸ºäº†åˆ†ææ³›å‹ç±»å‹ï¼Œå¯èƒ½ä¸ºnull</span>
 	<span class="token comment">// fieldï¼šç›®æ ‡çš„åå°„å­—æ®µï¼Œä¸ºäº†æ³›å‹ï¼Œå¯èƒ½ä¸ºnull</span>
	<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">convertIfNecessary</span><span class="token punctuation">(</span><span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> requiredType<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TypeMismatchException</span><span class="token punctuation">;</span>
	<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">convertIfNecessary</span><span class="token punctuation">(</span><span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> requiredType<span class="token punctuation">,</span> <span class="token class-name">MethodParameter</span> methodParam<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TypeMismatchException</span><span class="token punctuation">;</span>
	<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">convertIfNecessary</span><span class="token punctuation">(</span><span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> requiredType<span class="token punctuation">,</span> <span class="token class-name">Field</span> field<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TypeMismatchException</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®ƒæ˜¯Springå†…éƒ¨ä½¿ç”¨ç±»å‹è½¬æ¢çš„<strong>å…¥å£</strong>ï¼Œæœ€ç»ˆå§”æ‰˜ç»™<code>PropertyEditor</code>æˆ–è€…æ³¨å†Œåˆ°<code>ConversionService</code>é‡Œçš„è½¬æ¢å™¨å»å®Œæˆã€‚å®ƒçš„ä¸»è¦å®ç°æœ‰ï¼š</p><ul><li><code>TypeConverterSupport</code>ï¼š@since 3.2ã€‚ç»§æ‰¿è‡ª<code>PropertyEditorRegistrySupport</code>ï¼Œå®ƒä¸»è¦æ˜¯ä¸ºå­ç±»<code>BeanWrapperImpl</code>æä¾›åŠŸèƒ½æ”¯æ’‘ã€‚ä½œç”¨æœ‰å¦‚ä¸‹ä¸¤æ–¹é¢ï¼š</li></ul><blockquote><ol><li><p>æä¾›å¯¹<strong>é»˜è®¤ç¼–è¾‘å™¨</strong>ï¼ˆæ”¯æŒJDKå†…ç½®ç±»å‹çš„è½¬æ¢å¦‚ï¼šCharsetã€Classã€Class[]ã€Propertiesã€Collectionç­‰ç­‰ï¼‰å’Œ<strong>è‡ªå®šä¹‰ç¼–è¾‘å™¨</strong>çš„ç®¡ç†ï¼ˆPropertyEditorRegistry#registerCustomEditorï¼‰</p></li><li><p>æä¾›get/setæ–¹æ³•ï¼ŒæŠŠ<code>ConversionService</code>ç®¡ç†ä¸Šï¼ˆå¯é€‰ä¾èµ–ï¼Œå¯ä¸ºnullï¼‰</p></li></ol></blockquote><ul><li>æ•°æ®ç»‘å®šç›¸å…³ï¼šå› ä¸ºæ•°æ®ç»‘å®š<strong>å¼ºä¾èµ–äº</strong>ç±»å‹è½¬æ¢ï¼Œå› æ­¤æ•°æ®ç»‘å®šæ¶‰åŠåˆ°çš„å±æ€§è®¿é—®æ“ä½œå°†ä¼šä¾èµ–äºæ­¤ç»„ä»¶ï¼Œä¸ç®¡æ˜¯ç›´æ¥è®¿é—®å±æ€§çš„<code>DirectFieldAccessor</code>è¿˜æ˜¯åŠŸèƒ½æ›´å¼ºå¤§çš„<code>BeanWrapperImpl</code>å‡æ˜¯å¦‚æ­¤</li></ul><p>æ€»çš„æ¥è¯´ï¼Œ<code>TypeConverter</code>èƒ½æŠŠç±»å‹çš„å„ç§å®ç°ã€APIæ”¶å£äºæ­¤ï¼ŒSpringæŠŠç±»å‹è½¬æ¢çš„èƒ½åŠ›éƒ½è½¬å«åˆ°TypeConverterè¿™ä¸ªAPIé‡Œé¢å»äº†ã€‚</p><hr><h2 id="æ•°æ®ç»‘å®š" tabindex="-1"><a class="header-anchor" href="#æ•°æ®ç»‘å®š" aria-hidden="true">#</a> æ•°æ®ç»‘å®š</h2><h3 id="propertyaccessor" tabindex="-1"><a class="header-anchor" href="#propertyaccessor" aria-hidden="true">#</a> PropertyAccessor</h3><p>â€‹ å®ƒæ˜¯å¯ä»¥è®¿é—®å‘½åå±æ€§<code>named properties</code>ï¼ˆä¾‹å¦‚å¯¹è±¡çš„beanå±æ€§æˆ–å¯¹è±¡ä¸­çš„å­—æ®µï¼‰çš„ç±»çš„å…¬å…±æ¥å£ã€‚å¤§åé¼é¼çš„<code>BeanWrapper</code>æ¥å£ä¹Ÿç»§æ‰¿è‡ªå®ƒï¼Œå®ƒæ‰€åœ¨åŒ…æ˜¯<code>org.springframework.beans</code>ï¼ˆ<code>BeanWrapper</code>ä¹Ÿåœ¨æ­¤åŒ…ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// @since 1.1  å‡ºç°å¾—éå¸¸æ—©</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PropertyAccessor</span> <span class="token punctuation">{</span>

	<span class="token comment">// ç®€å•çš„è¯´å°±æ˜¯çº§è”å±æ€§çš„åˆ†éš”ç¬¦ã€‚</span>
	<span class="token comment">// æ¯”å¦‚foo.baræœ€ç»ˆä¼šè°ƒç”¨getFoo().getBar()ä¸¤ä¸ªæ–¹æ³•</span>
	<span class="token class-name">String</span> <span class="token constant">NESTED_PROPERTY_SEPARATOR</span> <span class="token operator">=</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token constant">NESTED_PROPERTY_SEPARATOR_CHAR</span> <span class="token operator">=</span> <span class="token char">&#39;.&#39;</span><span class="token punctuation">;</span>

	<span class="token comment">// ä»£è¡¨è§’æ ‡indexçš„ç¬¦å·  å¦‚person.addresses[0]  è¿™æ ·å°±å¯ä»¥æŠŠå€¼æ”¾è¿›é›†åˆ/æ•°ç»„/Mapé‡Œäº†</span>
	<span class="token class-name">String</span> <span class="token constant">PROPERTY_KEY_PREFIX</span> <span class="token operator">=</span> <span class="token string">&quot;[&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token constant">PROPERTY_KEY_PREFIX_CHAR</span> <span class="token operator">=</span> <span class="token char">&#39;[&#39;</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> <span class="token constant">PROPERTY_KEY_SUFFIX</span> <span class="token operator">=</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token constant">PROPERTY_KEY_SUFFIX_CHAR</span> <span class="token operator">=</span> <span class="token char">&#39;]&#39;</span><span class="token punctuation">;</span>


	<span class="token comment">// æ­¤å±æ€§æ˜¯å¦å¯è¯»ã€‚è‹¥å±æ€§ä¸å­˜åœ¨  è¿”å›false</span>
	<span class="token keyword">boolean</span> <span class="token function">isReadableProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// æ­¤å‡ºè¡Œæ˜¯å¦å¯å†™ã€‚è‹¥å±æ€§ä¸å­˜åœ¨ï¼Œè¿”å›false</span>
	<span class="token keyword">boolean</span> <span class="token function">isWritableProperty</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	

	<span class="token comment">// è¯»æ–¹æ³•</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPropertyType</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token class-name">TypeDescriptor</span> <span class="token function">getPropertyTypeDescriptor</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token class-name">Object</span> <span class="token function">getPropertyValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>

	<span class="token comment">// å†™æ–¹æ³•  </span>
	<span class="token keyword">void</span> <span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token class-name">PropertyValue</span> pv<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
	<span class="token comment">// æ‰¹é‡è®¾ç½®å€¼</span>
	<span class="token keyword">void</span> <span class="token function">setPropertyValues</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
	<span class="token comment">// è¯´æ˜ï¼šPropertyValueså’ŒPropertyValueå…³ç³»ç‰¹åˆ«åƒPropertySourceså’ŒPropertySourceçš„å…³ç³»</span>
	<span class="token keyword">void</span> <span class="token function">setPropertyValues</span><span class="token punctuation">(</span><span class="token class-name">PropertyValues</span> pvs<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>

	<span class="token comment">// å¯æ§åˆ¶æ˜¯å¦æ¥å—éæ³•çš„å­—æ®µã€valueå€¼æ‰½  ignoreUnknown/ignoreInvalidåˆ†åˆ«å¯¹åº”éæ³•å±æ€§å’Œéæ³•valueå€¼çš„å¤„ç†ç­–ç•¥~</span>
	<span class="token keyword">void</span> <span class="token function">setPropertyValues</span><span class="token punctuation">(</span><span class="token class-name">PropertyValues</span> pvs<span class="token punctuation">,</span> <span class="token keyword">boolean</span> ignoreUnknown<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">setPropertyValues</span><span class="token punctuation">(</span><span class="token class-name">PropertyValues</span> pvs<span class="token punctuation">,</span> <span class="token keyword">boolean</span> ignoreUnknown<span class="token punctuation">,</span> <span class="token keyword">boolean</span> ignoreInvalid<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="directfieldaccessor" tabindex="-1"><a class="header-anchor" href="#directfieldaccessor" aria-hidden="true">#</a> DirectFieldAccessor</h4><p>å®ƒç»§æ‰¿è‡ª<code>AbstractNestablePropertyAccessor</code>ï¼Œæ‰€ä»¥å®ƒè‚¯å®šä¹Ÿå°±å¯ä»¥å¤„ç†çº§è”å±æ€§å’Œé›†åˆæ•°ç»„å€¼äº†ã€‚ï¼ˆ<strong>è¯·æ³¨æ„ï¼Œåœ¨Spring4.2ä¹‹åæ”¯æŒï¼Œä¹‹å‰æ˜¯ä¸æ”¯æŒçš„~</strong>ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// @since 2.0   å‡ºç°å¾—å¯æ¯”çˆ¶ç±»`AbstractNestablePropertyAccessor`è¦æ—©å“¦~~~æ³¨æ„ï¼šçˆ¶ç±»çš„æ„é€ å‡½æ•°éƒ½æ˜¯protectedçš„</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DirectFieldAccessor</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractNestablePropertyAccessor</span> <span class="token punctuation">{</span>

	<span class="token comment">// ç¼“å­˜ç€æ¯ä¸ªå­—æ®µçš„å¤„ç†å™¨FieldPropertyHandler</span>
	<span class="token comment">// ReflectionUtils.findField()æ ¹æ®Stringå»æ‰¾åˆ°Fieldå¯¹è±¡çš„</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">FieldPropertyHandler</span><span class="token punctuation">&gt;</span></span> fieldMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token class-name">DirectFieldAccessor</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// è¿™ä¸ªæ„é€ å™¨ä¹Ÿæ˜¯protected çš„  æ‰€ä»¥è‹¥ä½ æƒ³è‡ªå·±æŒ‡å®šnestedPathå’Œparentï¼Œä½ å¯ä»¥ç»§æ‰¿æ­¤ç±»~~~</span>
	<span class="token keyword">protected</span> <span class="token class-name">DirectFieldAccessor</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token class-name">String</span> nestedPath<span class="token punctuation">,</span> <span class="token class-name">DirectFieldAccessor</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> nestedPath<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

	<span class="token comment">// å®ç°çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ï¼Œä¾æ—§ä½¿ç”¨DirectFieldAccessorå»å¤„ç†~~~</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">protected</span> <span class="token class-name">DirectFieldAccessor</span> <span class="token function">newNestedPropertyAccessor</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token class-name">String</span> nestedPath<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DirectFieldAccessor</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> nestedPath<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// å­—æ®µfieldå±æ€§å¤„ç†å™¨ï¼Œä½¿ç”¨å†…éƒ¨ç±»å®ç°PropertyHandler ~~~</span>
	<span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">FieldPropertyHandler</span> <span class="token keyword">extends</span> <span class="token class-name">PropertyHandler</span> <span class="token punctuation">{</span>
		<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Field</span> field<span class="token punctuation">;</span>
		<span class="token comment">// ä»æ­¤å¤„å¯ä»¥çœ‹å‡º`DirectFieldAccessor`é‡Œçš„fieldé»˜è®¤éƒ½æ˜¯å¯è¯»ã€å¯å†™çš„~~~~</span>
		<span class="token keyword">public</span> <span class="token class-name">FieldPropertyHandler</span><span class="token punctuation">(</span><span class="token class-name">Field</span> field<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">super</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>field <span class="token operator">=</span> field<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="demo" tabindex="-1"><a class="header-anchor" href="#demo" aria-hidden="true">#</a> demo</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ToString</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Apple</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> color<span class="token punctuation">;</span>

    <span class="token comment">// å¤æ‚ç±»å‹</span>
    <span class="token keyword">private</span> <span class="token class-name">Size</span> size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è‹¹æœçš„å°ºå¯¸ã€‚ å­˜åœ¨çº§è”</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrStr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> listStr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ›´ä¸ºå¤æ‚çš„ç±»å‹</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> listList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> listMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Apple</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        listList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        listMap<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token annotation punctuation">@ToString</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Size</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> height<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> width<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç±»<code>Apple</code>å±æ€§ä¸°å¯Œï¼Œ<strong>å¹¶ä¸”ç»Ÿä¸€éƒ½æ²¡æœ‰æä¾›get/setæ–¹æ³•</strong>ã€‚ä½¿ç”¨<code>DirectFieldAccessor</code>ç›´æ¥çš„å±æ€§è®¿é—®å™¨ç»™å…¶èµ‹å€¼ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Apple</span> apple <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Apple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">PropertyAccessor</span> accessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DirectFieldAccessor</span><span class="token punctuation">(</span>apple<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®æ™®é€šå±æ€§</span>
        accessor<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;çº¢è‰²&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®åµŒå¥—å±æ€§ï¼ˆæ³¨æ„ï¼šæ­¤å¤„èƒ½å¤Ÿæ­£å¸¸workæ˜¯å› ä¸ºæœ‰= new Size()ï¼Œ</span>
        <span class="token comment">// å¦åˆ™æŠ¥é”™ï¼šValue of nested property &#39;size&#39; is null ä¸‹åŒ~ï¼‰</span>
        accessor<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;size.height&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®é›†åˆ/æ•°ç»„å±æ€§</span>
        accessor<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;arrStr[0]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;arrStr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        accessor<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;arrStr[1]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;arrStr1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ³¨æ„ï¼šè™½ç„¶åˆå§‹åŒ–æ—¶åˆå§‹åŒ–è¿‡æ•°ç»„äº†ï¼Œä½†æ˜¯ä»ä»¥æ­¤å¤„çš„ä¸ºå‡†</span>
        accessor<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;listStr[0]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;listStr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        accessor<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;listStr[0]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;listStr1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¦‚æœè§’æ ‡indexä¸€æ ·ï¼Œåé¢è¦†ç›–å‰é¢çš„</span>
        <span class="token comment">// è™½ç„¶listStræ˜¯Stringçš„Listï¼Œä½†æ˜¯åå°„ç»•è¿‡äº†æ³›å‹  å¯ä»¥setè¿›å»ï¼Œä½†ä¸€getå°±æŠ¥é”™~~~éœ€è¦æ³¨æ„è¿™ä¸€ç‚¹</span>
        <span class="token comment">//accessor.setPropertyValue(&quot;listStr[0]&quot;, new Size());</span>
        <span class="token comment">//accessor.setPropertyValue(&quot;listStr[1]&quot;, 20);</span>
        <span class="token comment">//System.out.println(apple.getListStr().get(0)); //Cannot convert value of type &#39;com.fsx.bean.Size&#39; to required type &#39;java.lang.String&#39;</span>


        <span class="token comment">// è®¾ç½®Mapï¼škeyåªèƒ½æ˜¯æ•°å€¼æ‰è¡Œï¼Œå¦åˆ™æ˜¯ä¸å¥½ä½¿çš„~~~~</span>
        <span class="token comment">//accessor.setPropertyValue(&quot;map[&#39;aaa&#39;]&quot;,&quot;myValue1&quot;); //Caused by: java.lang.NumberFormatException: For input string: &quot;aaa&quot;</span>
        accessor<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;map[1]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;myValue2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®listListè¿™ç§é›†åˆé‡Œçš„é›†åˆ</span>
        accessor<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;listList[0][0]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;listList00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        accessor<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;listList[0][1]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;listList01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//accessor.setPropertyValue(&quot;listList[1][0]&quot;,&quot;listList10&quot;); //IndexOutOfBoundsException: Index: 1, Size: 1</span>
        <span class="token comment">//accessor.setPropertyValue(&quot;listList[1][1]&quot;,&quot;listList11&quot;); //IndexOutOfBoundsException: Index: 1, Size: 1</span>

        <span class="token comment">// è®¾ç½®listMapè¿™ç§é›†åˆé‡Œé¢æ”¾Map</span>
        accessor<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;listMap[0][0]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;listMap00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//accessor.setPropertyValue(&quot;listMap[0][&#39;myKey&#39;]&quot;,&quot;listMapkey&quot;); //For input string: &quot;myKey&quot;</span>


        <span class="token comment">// =========æ‰“å°è¾“å‡º</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>apple<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Apple(color=çº¢è‰², size=Size(height=10, width=null), arrStr=[arrStr, arrStr1], listStr=[listStr1], map={1=myValue2}, listList=[[listList00, listList01]], listMap=[{0=listMap00}])</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ç»“æœä¸­æ˜¯èƒ½å¤Ÿçœ‹å‡ºæ¥çš„ï¼Œä½¿ç”¨<code>DirectFieldAccessor</code>èƒ½å¤Ÿæ­£ç¡®å®Œæˆå±æ€§èµ‹å€¼ã€‚è¿™ä½¿ç”¨<code>DirectFieldAccessor</code>ä½œä¸ºå®ç°çš„è¯æœ‰å‡ ç‚¹ä½¿ç”¨å°ç»†èŠ‚éœ€è¦æ³¨æ„ï¼š</p><ol><li>è‹¥æ˜¯çº§è”å±æ€§ã€é›†åˆæ•°ç»„ç­‰å¤æ‚å±æ€§ï¼Œ<strong>åˆå§‹å€¼ä¸èƒ½ä¸ºnull</strong></li><li>ä½¿ç”¨å®ƒç»™å±æ€§èµ‹å€¼æ— åºæä¾›getã€setæ–¹æ³•ï¼ˆ<strong>ä¾§é¢æ„æ€æ˜¯ï¼šå®ƒä¸ä¼šèµ°ä½ çš„get/setæ–¹æ³•é€»è¾‘</strong>ï¼‰</li></ol><blockquote><p>â€‹ å½“ç„¶è‹¥ä½ å¸Œæœ›nullå€¼èƒ½å¤Ÿè¢«è‡ªåŠ¨åˆå§‹åŒ–ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè¯·è®¾å€¼ï¼š<code>accessor.setAutoGrowNestedPaths(true);</code>è¿™æ ·æ•°ç»„ã€é›†åˆã€Mapç­‰éƒ½ä¼šä¸ºnullæ—¶å€™ç»™ä½ åˆå§‹åŒ–(å…¶å®ƒBeanè¯·ä¿è¯æœ‰é»˜è®¤æ„é€ å‡½æ•°)</p></blockquote><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œ<code>DirectFieldAccessor</code>ä½¿ç”¨çš„åœºæ™¯ç›¸å¯¹è¾ƒå°‘ï¼Œä½†æœ‰ä¸ªå…¸å‹åº”ç”¨æ˜¯<code>Spring-Data-Redis</code>æœ‰ä½¿ç”¨<code>DirectFieldAccessor</code>æ¥è·å–å±æ€§å€¼</p><blockquote><p>è‹¥æˆ‘ä»¬å¼€å‘ä¸­åªæ˜¯å•çº¯çš„æƒ³<code>ç›´æ¥</code>è·å–å±æ€§å€¼ï¼Œä¸å¦¨å¯ä»¥ä½¿ç”¨å®ƒï¼Œå½¢å¦‚è¿™æ ·ï¼š<code>new DirectFieldAccessor(client).getPropertyValue(&quot;redisURI&quot;)</code>éå¸¸çš„æ–¹ä¾¿</p></blockquote><hr><h3 id="beanwrapper" tabindex="-1"><a class="header-anchor" href="#beanwrapper" aria-hidden="true">#</a> BeanWrapper</h3><p><code>BeanWrapper</code>å¯ä»¥ç®€å•çš„æŠŠå®ƒç†è§£ä¸ºï¼šä¸€ä¸ªæ–¹ä¾¿å¼€å‘äººå‘˜<strong>ä½¿ç”¨å­—ç¬¦ä¸²</strong>æ¥å¯¹<code>Java Bean</code>çš„å±æ€§æ‰§è¡Œgetã€setæ“ä½œçš„å·¥å…·ã€‚å…³äºå®ƒçš„æ•°æ®è½¬æ¢ä½¿ç”¨äº†å¦‚ä¸‹ä¸¤ç§æœºåˆ¶ï¼š</p><ol><li><code>PropertyEditor</code>ï¼šéš¶å±äº<strong>Java Beanè§„èŒƒ</strong>ã€‚<code>PropertyEditor</code>åªæä¾›äº†<code>String &lt;-&gt; Object</code>çš„è½¬æ¢ã€‚</li><li><code>ConversionService</code>ï¼šSpringè‡ª3.0ä¹‹åæä¾›çš„æ›¿ä»£PropertyEditorçš„æœºåˆ¶ï¼ˆ<code>BeanWrapper</code>åœ¨Springçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬å°±å­˜åœ¨äº†ï¼‰</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//@since 13 April 2001  å¾ˆæ¸…æ™°çš„çœ‹åˆ°ï¼Œå®ƒä¹Ÿæ˜¯ä¸ª`PropertyAccessor`å±æ€§è®¿é—®å™¨</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BeanWrapper</span> <span class="token keyword">extends</span> <span class="token class-name">ConfigurablePropertyAccessor</span> <span class="token punctuation">{</span>

	<span class="token comment">// @since 4.1</span>
	<span class="token keyword">void</span> <span class="token function">setAutoGrowCollectionLimit</span><span class="token punctuation">(</span><span class="token keyword">int</span> autoGrowCollectionLimit<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token function">getAutoGrowCollectionLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token class-name">Object</span> <span class="token function">getWrappedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getWrappedClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// è·å–å±æ€§ä»¬çš„PropertyDescriptor  è·å–å±æ€§ä»¬</span>
	<span class="token class-name">PropertyDescriptor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPropertyDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// è·å–å…·ä½“æŸä¸€ä¸ªå±æ€§~</span>
	<span class="token class-name">PropertyDescriptor</span> <span class="token function">getPropertyDescriptor</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InvalidPropertyException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>BeanWrapperç›¸å½“äºä¸€ä¸ªä»£ç†å™¨ï¼ŒSpringå§”æ‰˜<code>BeanWrapper</code>å®ŒæˆBeanå±æ€§çš„å¡«å……å·¥ä½œã€‚å…³äºæ­¤æ¥å£çš„å®ç°ç±»ï¼Œç®€å•çš„è¯´å®ƒåªæœ‰å”¯ä¸€å®ç°ç±»ï¼š<code>BeanWrapperImpl</code></p><h4 id="beanwrapperimpl" tabindex="-1"><a class="header-anchor" href="#beanwrapperimpl" aria-hidden="true">#</a> BeanWrapperImpl</h4><p>å®ƒä½œä¸º<code>BeanWrapper</code>æ¥å£çš„é»˜è®¤å®ç°ï¼Œå®ƒè¶³ä»¥æ»¡è¶³æ‰€æœ‰çš„å…¸å‹åº”ç”¨åœºæ™¯ï¼Œå®ƒä¼šç¼“å­˜Beançš„å†…çœç»“æœè€Œæé«˜æ•ˆç‡ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanWrapperImpl</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractNestablePropertyAccessor</span> <span class="token keyword">implements</span> <span class="token class-name">BeanWrapper</span> <span class="token punctuation">{</span>

	<span class="token comment">// ç¼“å­˜å†…çœç»“æœ~</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">CachedIntrospectionResults</span> cachedIntrospectionResults<span class="token punctuation">;</span>
	<span class="token comment">// The security context used for invoking the property methods.</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">AccessControlContext</span> acc<span class="token punctuation">;</span>

	<span class="token comment">// æ„é€ æ–¹æ³•éƒ½æ˜¯æ²¿ç”¨çˆ¶ç±»çš„~</span>
	<span class="token keyword">public</span> <span class="token class-name">BeanWrapperImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
	<span class="token keyword">private</span> <span class="token class-name">BeanWrapperImpl</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token class-name">String</span> nestedPath<span class="token punctuation">,</span> <span class="token class-name">BeanWrapperImpl</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> nestedPath<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">setSecurityContext</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>acc<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	<span class="token comment">// @since 4.3  è®¾ç½®ç›®æ ‡å¯¹è±¡~~~</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanInstance</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>wrappedObject <span class="token operator">=</span> object<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>rootObject <span class="token operator">=</span> object<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>typeConverterDelegate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TypeConverterDelegate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>wrappedObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// è®¾ç½®å†…çœçš„clazz</span>
		<span class="token function">setIntrospectionClass</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// å¤å†™çˆ¶ç±»çš„æ–¹æ³•  å¢åŠ å†…çœé€»è¾‘</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setWrappedInstance</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> nestedPath<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span> rootObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">setWrappedInstance</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> nestedPath<span class="token punctuation">,</span> rootObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">setIntrospectionClass</span><span class="token punctuation">(</span><span class="token function">getWrappedClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// å¦‚æœcachedIntrospectionResultså®ƒæŒæœ‰çš„BeanClasså¹¶ä¸æ˜¯ä¼ å…¥çš„clazz é‚£å°±æ¸…ç©ºç¼“å­˜ é‡æ–°æ¥~~~</span>
	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">setIntrospectionClass</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cachedIntrospectionResults <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cachedIntrospectionResults<span class="token punctuation">.</span><span class="token function">getBeanClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>cachedIntrospectionResults <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">private</span> <span class="token class-name">CachedIntrospectionResults</span> <span class="token function">getCachedIntrospectionResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cachedIntrospectionResults <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// forClassæ­¤æ–¹æ³•ï¼šç”Ÿæˆæ­¤clazzçš„ç±»å‹ç»“æœï¼Œå¹¶ä¸”ç¼“å­˜äº†èµ·æ¥~~</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>cachedIntrospectionResults <span class="token operator">=</span> <span class="token class-name">CachedIntrospectionResults</span><span class="token punctuation">.</span><span class="token function">forClass</span><span class="token punctuation">(</span><span class="token function">getWrappedClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cachedIntrospectionResults<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

	<span class="token comment">// è·å–åˆ°æ­¤å±æ€§çš„å¤„ç†å™¨ã€‚æ­¤å¤„æ˜¯ä¸ªBeanPropertyHandler å†…éƒ¨ç±»~</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">protected</span> <span class="token class-name">BeanPropertyHandler</span> <span class="token function">getLocalPropertyHandler</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">PropertyDescriptor</span> pd <span class="token operator">=</span> <span class="token function">getCachedIntrospectionResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPropertyDescriptor</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>pd <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">BeanPropertyHandler</span><span class="token punctuation">(</span>pd<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">protected</span> <span class="token class-name">BeanWrapperImpl</span> <span class="token function">newNestedPropertyAccessor</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token class-name">String</span> nestedPath<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BeanWrapperImpl</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> nestedPath<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">PropertyDescriptor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPropertyDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">getCachedIntrospectionResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPropertyDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// è·å–å…·ä½“æŸä¸€ä¸ªå±æ€§çš„PropertyDescriptor </span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">PropertyDescriptor</span> <span class="token function">getPropertyDescriptor</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InvalidPropertyException</span> <span class="token punctuation">{</span>
		<span class="token class-name">BeanWrapperImpl</span> nestedBw <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BeanWrapperImpl</span><span class="token punctuation">)</span> <span class="token function">getPropertyAccessorForPropertyPath</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">String</span> finalPath <span class="token operator">=</span> <span class="token function">getFinalPath</span><span class="token punctuation">(</span>nestedBw<span class="token punctuation">,</span> propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">PropertyDescriptor</span> pd <span class="token operator">=</span> nestedBw<span class="token punctuation">.</span><span class="token function">getCachedIntrospectionResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPropertyDescriptor</span><span class="token punctuation">(</span>finalPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pd <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InvalidPropertyException</span><span class="token punctuation">(</span><span class="token function">getRootClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getNestedPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> propertyName<span class="token punctuation">,</span> <span class="token string">&quot;No property &#39;&quot;</span> <span class="token operator">+</span> propertyName <span class="token operator">+</span> <span class="token string">&quot;&#39; found&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> pd<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

	<span class="token comment">// æ­¤å¤„ç†å™¨å¤„ç†çš„æ˜¯PropertyDescriptor </span>
	<span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">BeanPropertyHandler</span> <span class="token keyword">extends</span> <span class="token class-name">PropertyHandler</span> <span class="token punctuation">{</span>
		<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">PropertyDescriptor</span> pd<span class="token punctuation">;</span>

		<span class="token comment">// æ˜¯å¦å¯è¯»ã€å¯å†™  éƒ½æ˜¯ç”±PropertyDescriptor å»å†³å®šäº†~</span>
		<span class="token comment">// java.beans.PropertyDescriptor~~</span>
		<span class="token keyword">public</span> <span class="token class-name">BeanPropertyHandler</span><span class="token punctuation">(</span><span class="token class-name">PropertyDescriptor</span> pd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">super</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span><span class="token function">getPropertyType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pd<span class="token punctuation">.</span><span class="token function">getReadMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> pd<span class="token punctuation">.</span><span class="token function">getWriteMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>pd <span class="token operator">=</span> pd<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token annotation punctuation">@Override</span>
		<span class="token annotation punctuation">@Nullable</span>
		<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
			<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
			<span class="token class-name">ReflectionUtils</span><span class="token punctuation">.</span><span class="token function">makeAccessible</span><span class="token punctuation">(</span>readMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> readMethod<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token function">getWrappedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ç»§æ‰¿ä½“ç³»ä¸Šï¼Œé¦–å…ˆæˆ‘ä»¬åº”è¯¥èƒ½çœ‹å‡ºæ¥<code>BeanWrapperImpl</code>çš„ä¸‰é‡èº«ä»½ï¼š</p><ol><li><strong>BeanåŒ…è£¹å™¨</strong></li><li>å±æ€§è®¿é—®å™¨ï¼ˆPropertyAccessorï¼‰</li><li>å±æ€§ç¼–è¾‘å™¨æ³¨å†Œè¡¨ï¼ˆPropertyEditorRegistryï¼‰</li></ol><p>ä»æºç ä¸­ç»§ç»­åˆ†æè¿˜èƒ½å†å¾—å‡ºå¦‚ä¸‹ä¸¤ä¸ªç»“è®ºï¼š</p><ol><li>å®ƒç»™å±æ€§èµ‹å€¼è°ƒç”¨çš„æ˜¯Methodæ–¹æ³•ï¼Œå¦‚<code>readMethod.invoke</code>å’Œ<code>writeMethod.invoke</code></li><li>å®ƒå¯¹Beançš„æ“ä½œï¼Œå¤§éƒ½å§”æ‰˜ç»™<code>CachedIntrospectionResults</code>å»å®Œæˆ~</li></ol><h4 id="demo-1" tabindex="-1"><a class="header-anchor" href="#demo-1" aria-hidden="true">#</a> demo</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// çœç•¥Appleç±»å’ŒSizeç±»ï¼Œæœ‰éœ€è¦çš„è¯·å‚ç…§ä¸Šç¯‡æ–‡ç« ï¼ˆåŠ ä¸Š@Getterã€@Setterå³å¯</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Apple</span> apple <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Apple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">BeanWrapper</span> beanWrapper <span class="token operator">=</span> <span class="token class-name">PropertyAccessorFactory</span><span class="token punctuation">.</span><span class="token function">forBeanPropertyAccess</span><span class="token punctuation">(</span>apple<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ================å½“ä½œä¸€ä¸ªæ™®é€šçš„PropertyAccessoræ¥ä½¿ç”¨  é»˜è®¤æƒ…å†µä¸‹å­—æ®µä¹Ÿéƒ½å¿…é¡»æœ‰åˆå§‹å€¼æ‰è¡Œ~===================</span>
        <span class="token comment">// è®¾ç½®æ™®é€šå±æ€§</span>
        beanWrapper<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;çº¢è‰²&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¯·ä¿è¯å¯¹åº”å­—æ®µæœ‰setæ–¹æ³•æ‰è¡Œï¼Œå¦åˆ™æŠ›é”™ï¼šDoes the parameter type of the setter match the return type of the getter?</span>
        <span class="token comment">// è®¾ç½®åµŒå¥—å±æ€§ï¼ˆæ³¨æ„ï¼šæ­¤å¤„èƒ½å¤Ÿæ­£å¸¸workæ˜¯å› ä¸ºæœ‰= new Size()ï¼Œ</span>
        <span class="token comment">// å¦åˆ™æŠ¥é”™ï¼šValue of nested property &#39;size&#39; is null ä¸‹åŒ~ï¼‰</span>
        beanWrapper<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;size.height&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®é›†åˆ/æ•°ç»„å±æ€§</span>
        beanWrapper<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;arrStr[0]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;arrStr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beanWrapper<span class="token punctuation">.</span><span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token string">&quot;arrStr[1]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;arrStr1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ³¨æ„ï¼šè™½ç„¶åˆå§‹åŒ–æ—¶åˆå§‹åŒ–è¿‡æ•°ç»„äº†ï¼Œä½†æ˜¯ä»ä»¥æ­¤å¤„çš„ä¸ºå‡†</span>
        <span class="token comment">// =========æ‰“å°è¾“å‡º</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>apple<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Apple(color=çº¢è‰², size=Size(height=10, width=null), arrStr=[arrStr, arrStr1], listStr=[], map={}, listList=[[]], listMap=[{}])</span>


        <span class="token comment">// å½“ä½œBeanWrapperä½¿ç”¨</span>
        <span class="token class-name">PropertyDescriptor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> propertyDescriptors <span class="token operator">=</span> beanWrapper<span class="token punctuation">.</span><span class="token function">getPropertyDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PropertyDescriptor</span> color <span class="token operator">=</span> beanWrapper<span class="token punctuation">.</span><span class="token function">getPropertyDescriptor</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>propertyDescriptors<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 8</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//org.springframework.beans.GenericTypeAwarePropertyDescriptor[name=color]</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>beanWrapper<span class="token punctuation">.</span><span class="token function">getWrappedClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//class com.fsx.bean.Apple</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>beanWrapper<span class="token punctuation">.</span><span class="token function">getWrappedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Apple(color=çº¢è‰², size=Size(height=10...</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="iocç»“åˆå†…çœä¸beanwrapper" tabindex="-1"><a class="header-anchor" href="#iocç»“åˆå†…çœä¸beanwrapper" aria-hidden="true">#</a> IOCç»“åˆå†…çœä¸BeanWrapper</h4><p>â€‹ Springéœ€è¦ä¾èµ–æ³¨å…¥å°±éœ€è¦ä½¿ç”¨<code>BeanWrapper</code>ï¼Œä¸Šç« èŠ‚è¯´äº†<code>BeanWrapperImpl</code>çš„å®ç°å¤§éƒ½å§”æ‰˜ç»™äº†<code>CachedIntrospectionResults</code>å»å®Œæˆï¼Œè€Œ<code>CachedIntrospectionResults</code>å®ƒçš„æ ¸å¿ƒè¯´æ³•å°±æ˜¯<strong>Javaå†…çœæœºåˆ¶</strong>ã€‚ä»å±‚å±‚å§”æ‰˜çš„ä¾èµ–å…³ç³»å¯ä»¥çœ‹å‡ºï¼Œ<code>Spring IoC</code>çš„ä¾èµ–æ³¨å…¥ï¼ˆç»™å±æ€§èµ‹å€¼ï¼‰æ˜¯å±‚å±‚å§”æ‰˜çš„æœ€ç»ˆç»™äº†Javaå†…çœæœºåˆ¶ï¼Œè¿™æ˜¯Springæ¡†æ¶è®¾è®¡ç²¾å¦™å¤„ä¹‹ä¸€ã€‚è¿™ä¹Ÿç¬¦åˆæˆ‘ä¸Šæ–‡æ‰€è¯‰ï¼š<code>BeanWrapper</code><strong>è¿™ä¸ªæ¥å£å¹¶ä¸å»ºè®®åº”ç”¨è‡ªå·±å»ç›´æ¥ä½¿ç”¨</strong></p><figure><img src="https://raw.githubusercontent.com/nocetfy/image/main/img/image-20231105164428250.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h5 id="docreatebean-åˆ›å»ºbean" tabindex="-1"><a class="header-anchor" href="#docreatebean-åˆ›å»ºbean" aria-hidden="true">#</a> doCreateBean() åˆ›å»ºBean</h5><p>ä»»ä½•åˆ›å»ºBeançš„è¿‡ç¨‹ï¼Œéƒ½å¾—ç»å†<code>doCreateBean()</code>ã€‚è¿™å¥ä»£ç æˆ‘ä»¬å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œå®ƒåœ¨<code>AbstractAutowireCapableBeanFactory</code>é‡Œï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	<span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">doCreateBean</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">RootBeanDefinition</span> mbd<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeanCreationException</span> <span class="token punctuation">{</span>
		<span class="token class-name">BeanWrapper</span> instanceWrapper <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token comment">// è¿™ä¸€æ­¥ç®€å•çš„è¯´ï¼šé€šè¿‡æ„é€ å‡½æ•°å®ä¾‹åŒ–Beanåï¼Œnew BeanWrapperImpl(beanInstance)åŒ…è£…èµ·æ¥</span>
		<span class="token comment">// å¹¶ä¸”ï¼šinitBeanWrapper(bw);  ä½œç”¨æ˜¯æ³¨å†ŒConversionServiceå’ŒregisterCustomEditors() ...</span>
		instanceWrapper <span class="token operator">=</span> <span class="token function">createBeanInstance</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token comment">// ç»™å±æ€§èµ‹å€¼ï¼šæ­¤å¤„ä¼šå®æ–½BeanWrapperçš„çœŸæ­£å®åŠ›~~~~</span>
		<span class="token comment">// æ³¨æ„ï¼šæ­¤å¤„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯BeanWrapperï¼Œè€Œä¸æ˜¯æºç”Ÿbeanduixiang~~~ </span>
		<span class="token function">populateBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> instanceWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
		exposedObject <span class="token operator">=</span> <span class="token function">initializeBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> exposedObject<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ <code>doCreateBean</code>è¿™ä¸ªæ–¹æ³•å®Œæˆæ•´ä¸ªBeançš„å®ä¾‹åŒ–ã€åˆå§‹åŒ–ã€‚è€Œè¿™é‡Œé¢æˆ‘ä»¬æœ€ä¸ºå…³æ³¨çš„è‡ªç„¶å°±æ˜¯<code>populateBean()</code>è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯å®Œæˆç»™å±æ€§èµ‹å€¼ï¼Œä»æ—¶åºå›¾ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ªå…¥å£</p><h5 id="populatebean-ç»™beançš„å±æ€§èµ‹å€¼" tabindex="-1"><a class="header-anchor" href="#populatebean-ç»™beançš„å±æ€§èµ‹å€¼" aria-hidden="true">#</a> populateBean()ï¼šç»™Beançš„å±æ€§èµ‹å€¼</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">populateBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">RootBeanDefinition</span> mbd<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">BeanWrapper</span> bw<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token comment">// ä»Beanå®šä¹‰é‡Œé¢æŠŠå‡†å¤‡å¥½çš„å€¼éƒ½æ‹¿å‡ºæ¥~~~</span>
		<span class="token comment">// å®ƒæ˜¯ä¸ªMutablePropertyValuesï¼ŒæŒæœ‰Nå¤šä¸ªå±æ€§çš„å€¼~~~</span>
		<span class="token class-name">PropertyValues</span> pvs <span class="token operator">=</span> <span class="token punctuation">(</span>mbd<span class="token punctuation">.</span><span class="token function">hasPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> mbd<span class="token punctuation">.</span><span class="token function">getPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">BeanPostProcessor</span> bp <span class="token operator">:</span> <span class="token function">getBeanPostProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
			<span class="token comment">// æ­¤å¤„ä¼šä»åç½®å¤„ç†ï¼Œä»é‡Œé¢æŠŠä¾èµ–çš„å±æ€§ï¼Œå€¼éƒ½æ‹¿åˆ°ã€‚æ¯”å¦‚å¤§åé¼é¼çš„AutowiredAnnotationBeanPostProcessorå°±æ˜¯åœ¨æ­¤å¤„æ‹¿å‡ºå€¼çš„~~~</span>
			<span class="token class-name">PropertyValues</span> pvsToUse <span class="token operator">=</span> ibp<span class="token punctuation">.</span><span class="token function">postProcessProperties</span><span class="token punctuation">(</span>pvs<span class="token punctuation">,</span> bw<span class="token punctuation">.</span><span class="token function">getWrappedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
			pvs <span class="token operator">=</span> pvsToUse<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token comment">// è‹¥å­˜åœ¨å±æ€§pvs ï¼Œé‚£å°±åšèµ‹å€¼æ“ä½œå§~~~ï¼ˆæœ¬å¤„æ‰æ˜¯ä»Šå¤©å…³å¿ƒçš„é‡ç‚¹~~~ï¼‰</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pvs <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">applyPropertyValues</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> bw<span class="token punctuation">,</span> pvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æ·±å…¥åˆ°æ–¹æ³•å†…éƒ¨ï¼Œå®ƒå®Œæˆäº†k-vå€¼çš„å‡†å¤‡å·¥ä½œï¼Œå¾ˆå¤šé‡è¦çš„<code>BeanPostProcessor</code>ä¹Ÿåœ¨æ­¤å¤„å¾—åˆ°æ‰§è¡Œã€‚å¯¹äºæœ€ç»ˆç»™å±æ€§èµ‹å€¼çš„æ­¥éª¤ï¼Œæ˜¯äº¤ç»™äº†æœ¬ç±»çš„<code>applyPropertyValues()</code>æ–¹æ³•å»å®Œæˆ</p><h5 id="applypropertyvalues-å®Œæˆå±æ€§èµ‹å€¼" tabindex="-1"><a class="header-anchor" href="#applypropertyvalues-å®Œæˆå±æ€§èµ‹å€¼" aria-hidden="true">#</a> applyPropertyValuesï¼šå®Œæˆå±æ€§èµ‹å€¼</h5><p>è¿™ä¸ªæ–¹æ³•çš„å¤„ç†å†…å®¹æ‰æ˜¯æœ¬æ–‡<strong>æœ€åº”è¯¥å…³æ³¨çš„æ ¸å¿ƒ</strong>ï¼Œå®ƒåœ¨å¤„ç†æ•°æ®è§£æã€è½¬æ¢è¿™ä¸€å—è¿˜æ˜¯å­˜åœ¨ä¸å°çš„å¤æ‚åº¦çš„~</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	<span class="token comment">// æœ¬æ–¹æ³•ä¼ å…¥äº†beanNameå’Œbeanå®šä¹‰ä¿¡æ¯ï¼Œä»¥åŠå®ƒå¯¹åº”çš„BeanWrapperå’Œvalueå€¼ä»¬~</span>
	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">applyPropertyValues</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span> mbd<span class="token punctuation">,</span> <span class="token class-name">BeanWrapper</span> bw<span class="token punctuation">,</span> <span class="token class-name">PropertyValues</span> pvs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pvs<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token class-name">MutablePropertyValues</span> mpvs <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PropertyValue</span><span class="token punctuation">&gt;</span></span> original<span class="token punctuation">;</span>

		<span class="token comment">// è¯´æ˜ä¸€ä¸‹ï¼šä¸ºä½•è¿™é‡Œè¿˜æ˜¯è¦åˆ¤æ–­ä¸€ä¸‹ï¼Œè™½ç„¶Springå¯¹PropertyValuesçš„å†…å»ºå®ç°åªæœ‰MutablePropertyValues</span>
		<span class="token comment">// ä½†æ˜¯è¿™ä¸ªæ˜¯è°ƒç”¨è€…è‡ªå·±ä¹Ÿå¯ä»¥å®ç°é€»è¾‘çš„~~~soåˆ¤æ–­ä¸€ä¸‹æœ€ä½³~~~~</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pvs <span class="token keyword">instanceof</span> <span class="token class-name">MutablePropertyValues</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			mpvs <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MutablePropertyValues</span><span class="token punctuation">)</span> pvs<span class="token punctuation">;</span>
			<span class="token comment">// æ­¤å¤„æœ‰ä¸ªçŸ­è·¯å¤„ç†ï¼š</span>
			<span class="token comment">// è‹¥è¯¥mpvsä¸­çš„æ‰€æœ‰å±æ€§å€¼éƒ½å·²ç»è½¬æ¢ä¸ºå¯¹åº”çš„ç±»å‹ï¼Œåˆ™æŠŠmpvsè®¾ç½®åˆ°BeanWrapperä¸­ï¼Œè¿”å›</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>mpvs<span class="token punctuation">.</span><span class="token function">isConverted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// Shortcut: use the pre-converted values as-is.</span>
				<span class="token keyword">try</span> <span class="token punctuation">{</span>
					bw<span class="token punctuation">.</span><span class="token function">setPropertyValues</span><span class="token punctuation">(</span>mpvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">return</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BeansException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanCreationException</span><span class="token punctuation">(</span>mbd<span class="token punctuation">.</span><span class="token function">getResourceDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> <span class="token string">&quot;Error setting property values&quot;</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token comment">// å¦åˆ™ï¼Œæ‹¿åˆ°é‡Œé¢çš„å±æ€§å€¼ä»¬~~~</span>
			original <span class="token operator">=</span> mpvs<span class="token punctuation">.</span><span class="token function">getPropertyValueList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			original <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>pvs<span class="token punctuation">.</span><span class="token function">getPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// æ˜¾ç„¶ï¼Œè‹¥è°ƒç”¨è€…æ²¡æœ‰è‡ªå®šä¹‰è½¬æ¢å™¨ï¼Œé‚£å°±ä½¿ç”¨BeanWrapperæœ¬èº«~~~ï¼ˆå› ä¸ºBeanWrapperå®ç°äº†TypeConverter æ¥å£~~ï¼‰</span>
		<span class="token class-name">TypeConverter</span> converter <span class="token operator">=</span> <span class="token function">getCustomTypeConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>converter <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			converter <span class="token operator">=</span> bw<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// è·å–BeanDefinitionValueResolverï¼Œè¯¥Beanç”¨äºå°†beanå®šä¹‰å¯¹è±¡ä¸­åŒ…å«çš„å€¼è§£æä¸ºåº”ç”¨äºç›®æ ‡beanå®ä¾‹çš„å®é™…å€¼ã€‚</span>
		<span class="token class-name">BeanDefinitionValueResolver</span> valueResolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinitionValueResolver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> converter<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// Create a deep copy, resolving any references for values.</span>
		<span class="token comment">// æ­¤å¤„ç¿»è¯‘æˆæ·±åº¦æ‹·è´ä¸åˆé€‚ï¼Œå€’ä¸å¦‚ç¿»è¯‘æˆæ·±åº¦è§£ææ›´ä¸ºåˆç†~~~~</span>
		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PropertyValue</span><span class="token punctuation">&gt;</span></span> deepCopy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>original<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">boolean</span> resolveNecessary <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

		<span class="token comment">// éå†æ²¡æœ‰è¢«è§£æçš„originalå±æ€§å€¼ä»¬~~~~</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PropertyValue</span> pv <span class="token operator">:</span> original<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>pv<span class="token punctuation">.</span><span class="token function">isConverted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				deepCopy<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>pv<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// é‚£ç§è¿˜æ²¡è¢«è§£æè¿‡çš„PropertyValueæ­¤å¤„ä¼šä¸€æ­¥æ­¥è§£æ~~~~</span>
				<span class="token class-name">String</span> propertyName <span class="token operator">=</span> pv<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å±æ€§åç§°</span>
				<span class="token class-name">Object</span> originalValue <span class="token operator">=</span> pv<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æœªç»ç±»å‹è½¬æ¢çš„å€¼ï¼ˆæ³¨æ„ï¼šæ˜¯æœªç»è½¬æ¢çš„ï¼Œå¯èƒ½è¿˜åªæ˜¯ä¸ªå­—ç¬¦ä¸²æˆ–è€…è¡¨è¾¾å¼è€Œå·²~~~~ï¼‰</span>

				<span class="token comment">// æœ€ä¸ºå¤æ‚çš„è§£æé€»è¾‘~~~</span>
				<span class="token class-name">Object</span> resolvedValue <span class="token operator">=</span> valueResolver<span class="token punctuation">.</span><span class="token function">resolveValueIfNecessary</span><span class="token punctuation">(</span>pv<span class="token punctuation">,</span> originalValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token class-name">Object</span> convertedValue <span class="token operator">=</span> resolvedValue<span class="token punctuation">;</span>

				<span class="token comment">// å±æ€§å¯å†™ å¹¶ä¸” ä¸æ˜¯åµŒå¥—ï¼ˆå¦‚foo.barï¼Œjavaä¸­ç”¨getFoo().getBar()è¡¨ç¤ºï¼‰æˆ–è€…ç´¢å¼•ï¼ˆå¦‚person.addresses[0]ï¼‰å±æ€§</span>
				<span class="token keyword">boolean</span> convertible <span class="token operator">=</span> bw<span class="token punctuation">.</span><span class="token function">isWritableProperty</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token class-name">PropertyAccessorUtils</span><span class="token punctuation">.</span><span class="token function">isNestedOrIndexedProperty</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>convertible<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// ç”¨ç±»å‹è½¬æ¢å™¨è¿›è¡Œè½¬æ¢</span>
					convertedValue <span class="token operator">=</span> <span class="token function">convertForProperty</span><span class="token punctuation">(</span>resolvedValue<span class="token punctuation">,</span> propertyName<span class="token punctuation">,</span> bw<span class="token punctuation">,</span> converter<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>resolvedValue <span class="token operator">==</span> originalValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>convertible<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						pv<span class="token punctuation">.</span><span class="token function">setConvertedValue</span><span class="token punctuation">(</span>convertedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					deepCopy<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>pv<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>convertible <span class="token operator">&amp;&amp;</span> originalValue <span class="token keyword">instanceof</span> <span class="token class-name">TypedStringValue</span> <span class="token operator">&amp;&amp;</span>
						<span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TypedStringValue</span><span class="token punctuation">)</span> originalValue<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isDynamic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
						<span class="token operator">!</span><span class="token punctuation">(</span>convertedValue <span class="token keyword">instanceof</span> <span class="token class-name">Collection</span> <span class="token operator">||</span> <span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>convertedValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					pv<span class="token punctuation">.</span><span class="token function">setConvertedValue</span><span class="token punctuation">(</span>convertedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
					deepCopy<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>pv<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token punctuation">{</span>
					resolveNecessary <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
					deepCopy<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PropertyValue</span><span class="token punctuation">(</span>pv<span class="token punctuation">,</span> convertedValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// æ ‡è®°mpvså·²ç»è½¬æ¢</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>mpvs <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>resolveNecessary<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			mpvs<span class="token punctuation">.</span><span class="token function">setConverted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// Set our (possibly massaged) deep copy.</span>
		<span class="token comment">// ä½¿ç”¨è½¬æ¢åçš„å€¼è¿›è¡Œå¡«å……~~~~~~~~~~</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			bw<span class="token punctuation">.</span><span class="token function">setPropertyValues</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MutablePropertyValues</span><span class="token punctuation">(</span>deepCopy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BeansException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanCreationException</span><span class="token punctuation">(</span>mbd<span class="token punctuation">.</span><span class="token function">getResourceDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> <span class="token string">&quot;Error setting property values&quot;</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span>

	<span class="token comment">// å±æ€§å€¼çš„è½¬æ¢</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">Object</span> <span class="token function">convertForProperty</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token class-name">String</span> propertyName<span class="token punctuation">,</span> <span class="token class-name">BeanWrapper</span> bw<span class="token punctuation">,</span> <span class="token class-name">TypeConverter</span> converter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼šconvertForPropertyæ–¹æ³•æ˜¯BeanWrapperImplçš„å®ä¾‹æ–¹æ³•ï¼Œå¹¶éæ¥å£æ–¹æ³•</span>
		<span class="token comment">// è¿™ä¸ªæ–¹æ³•å†…éƒ¨å°±ç”¨åˆ°äº†CachedIntrospectionResultsï¼Œä»ä½•å°±å’ŒJavaå†…çœæ­ä¸Šäº†å…³ç³»~~~</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>converter <span class="token keyword">instanceof</span> <span class="token class-name">BeanWrapperImpl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">BeanWrapperImpl</span><span class="token punctuation">)</span> converter<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">convertForProperty</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// è‡ªå®šä¹‰è½¬æ¢å™¨</span>
			<span class="token class-name">PropertyDescriptor</span> pd <span class="token operator">=</span> bw<span class="token punctuation">.</span><span class="token function">getPropertyDescriptor</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">MethodParameter</span> methodParam <span class="token operator">=</span> <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">getWriteMethodParameter</span><span class="token punctuation">(</span>pd<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> converter<span class="token punctuation">.</span><span class="token function">convertIfNecessary</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> pd<span class="token punctuation">.</span><span class="token function">getPropertyType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> methodParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>applyPropertyValues()</code>è¿™ä¸€æ­¥å®Œæˆä¹‹åï¼Œå°±å½»åº•å®Œæˆäº†å¯¹Beanå®ä¾‹å±æ€§çš„èµ‹å€¼ã€‚ä»ä¸­å¯ä»¥çœ‹åˆ°æœ€ç»ˆçš„èµ‹å€¼æ“ä½œï¼Œæ ¸å¿ƒä¾èµ–çš„å°±æ˜¯è¿™ä¹ˆä¸€å¥è¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>bw<span class="token punctuation">.</span><span class="token function">setPropertyValues</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MutablePropertyValues</span><span class="token punctuation">(</span>deepCopy<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>â€‹ å¹¶ä¸”ä»è½¬æ¢çš„é€»è¾‘æˆ‘ä»¬ä¹Ÿéœ€è¦çŸ¥é“çš„æ˜¯ï¼šIoCå¹¶ä¸æ˜¯100%å¾—ä½¿ç”¨<code>BeanWrapper</code>çš„ï¼Œè‹¥æˆ‘ä»¬æ˜¯è‡ªå®šä¹‰äº†ä¸€ä¸ªè½¬æ¢å™¨ï¼Œå…¶å®æ˜¯<strong>å¯ä»¥ä¸ç»è¿‡Javaå†…çœæœºåˆ¶</strong>ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡åå°„æ¥å®ç°çš„ï¼Œå½“ç„¶å¹¶ä¸å»ºè®®è¿™ä¹ˆå»åšã€‚</p><p>â€‹ <code>BeanWrapper</code>ä½“ç³»ç›¸æ¯”äº Spring ä¸­å…¶ä»–ä½“ç³»æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå®ƒä½œä¸º<code>BeanDefinition</code>å‘ <code>Bean</code>è½¬æ¢è¿‡ç¨‹ä¸­çš„<strong>ä¸­é—´äº§ç‰©</strong>ï¼Œæ‰¿è½½äº† bean å®ä¾‹çš„<strong>åŒ…è£…ã€ç±»å‹è½¬æ¢ã€å±æ€§çš„è®¾ç½®</strong>ä»¥åŠ<strong>è®¿é—®</strong>ç­‰é‡è¦ä½œç”¨ï¼ˆè¯·ä¸è¦è½äº†è®¿é—®è¿™ä¸ªé‡è¦èƒ½åŠ›ï¼‰ã€‚</p><hr><h3 id="databinder" tabindex="-1"><a class="header-anchor" href="#databinder" aria-hidden="true">#</a> DataBinder</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataBinder</span> <span class="token keyword">implements</span> <span class="token class-name">PropertyEditorRegistry</span><span class="token punctuation">,</span> <span class="token class-name">TypeConverter</span> <span class="token punctuation">{</span>

	<span class="token doc-comment comment">/** Default object name used for binding: &quot;target&quot;. */</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DEFAULT_OBJECT_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;target&quot;</span><span class="token punctuation">;</span>
	<span class="token doc-comment comment">/** Default limit for array and collection growing: 256. */</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">DEFAULT_AUTO_GROW_COLLECTION_LIMIT</span> <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> target<span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> objectName<span class="token punctuation">;</span> <span class="token comment">// é»˜è®¤å€¼æ˜¯target</span>

	<span class="token comment">// BindingResultï¼šç»‘å®šé”™è¯¯ã€å¤±è´¥çš„æ—¶å€™ä¼šæ”¾è¿›è¿™é‡Œæ¥~</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">AbstractPropertyBindingResult</span> bindingResult<span class="token punctuation">;</span>

	<span class="token comment">//ç±»å‹è½¬æ¢å™¨ï¼Œä¼šæ³¨å†Œæœ€ä¸ºå¸¸ç”¨çš„é‚£ä¹ˆå¤šç±»å‹è½¬æ¢Map&lt;Class&lt;?&gt;, PropertyEditor&gt; defaultEditors</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">SimpleTypeConverter</span> typeConverter<span class="token punctuation">;</span>

	<span class="token comment">// é»˜è®¤å¿½ç•¥ä¸èƒ½è¯†åˆ«çš„å­—æ®µ~</span>
	<span class="token keyword">private</span> <span class="token keyword">boolean</span> ignoreUnknownFields <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token comment">// ä¸èƒ½å¿½ç•¥éæ³•çš„å­—æ®µï¼ˆæ¯”å¦‚æˆ‘è¦Integerï¼Œä½ ç»™ä¼ aaaï¼Œé‚£è‚¯å®šå°±ä¸è®©ç»‘å®šäº†ï¼ŒæŠ›é”™ï¼‰</span>
	<span class="token keyword">private</span> <span class="token keyword">boolean</span> ignoreInvalidFields <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token comment">// é»˜è®¤æ˜¯æ”¯æŒçº§è”çš„~~~</span>
	<span class="token keyword">private</span> <span class="token keyword">boolean</span> autoGrowNestedPaths <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token keyword">int</span> autoGrowCollectionLimit <span class="token operator">=</span> <span class="token constant">DEFAULT_AUTO_GROW_COLLECTION_LIMIT</span><span class="token punctuation">;</span>

	<span class="token comment">// è¿™ä¸‰ä¸ªå‚æ•°  éƒ½å¯ä»¥è‡ªå·±æŒ‡å®š~~ å…è®¸çš„å­—æ®µã€ä¸å…è®¸çš„ã€å¿…é¡»çš„</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> allowedFields<span class="token punctuation">;</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> disallowedFields<span class="token punctuation">;</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> requiredFields<span class="token punctuation">;</span>

	<span class="token comment">// è½¬æ¢å™¨ConversionService</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">ConversionService</span> conversionService<span class="token punctuation">;</span>
	<span class="token comment">// çŠ¶æ€ç å¤„ç†å™¨~</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">private</span> <span class="token class-name">MessageCodesResolver</span> messageCodesResolver<span class="token punctuation">;</span>
	<span class="token comment">// ç»‘å®šå‡ºç°é”™è¯¯çš„å¤„ç†å™¨~</span>
	<span class="token keyword">private</span> <span class="token class-name">BindingErrorProcessor</span> bindingErrorProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultBindingErrorProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// æ ¡éªŒå™¨ï¼ˆè¿™ä¸ªéå¸¸é‡è¦ï¼‰</span>
	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Validator</span><span class="token punctuation">&gt;</span></span> validators <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//  objectNameæ²¡æœ‰æŒ‡å®šï¼Œå°±ç”¨é»˜è®¤çš„</span>
	<span class="token keyword">public</span> <span class="token class-name">DataBinder</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token constant">DEFAULT_OBJECT_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token class-name">DataBinder</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span> target<span class="token punctuation">,</span> <span class="token class-name">String</span> objectName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">unwrapOptional</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>objectName <span class="token operator">=</span> objectName<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">// çœç•¥æ‰€æœ‰å±æ€§çš„get/setæ–¹æ³•</span>

	<span class="token comment">// æä¾›ä¸€äº›åˆ—çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä¾›ç»™å­ç±»ä½¿ç”¨ æˆ–è€…å¤–éƒ¨ä½¿ç”¨  ä¸‹é¢ä¸¤ä¸ªåˆå§‹åŒ–æ–¹æ³•æ˜¯äº’æ–¥çš„</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initBeanPropertyAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>bindingResult <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;DataBinder is already initialized - call initBeanPropertyAccess before other configuration methods&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>bindingResult <span class="token operator">=</span> <span class="token function">createBeanPropertyBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">protected</span> <span class="token class-name">AbstractPropertyBindingResult</span> <span class="token function">createBeanPropertyBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">BeanPropertyBindingResult</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanPropertyBindingResult</span><span class="token punctuation">(</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getObjectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">isAutoGrowNestedPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getAutoGrowCollectionLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>conversionService <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			result<span class="token punctuation">.</span><span class="token function">initConversion</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>conversionService<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>messageCodesResolver <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			result<span class="token punctuation">.</span><span class="token function">setMessageCodesResolver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>messageCodesResolver<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> result<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// ä½ ä¼šå‘ç°ï¼Œåˆå§‹åŒ–DirectFieldAccessçš„æ—¶å€™ï¼Œæ ¡éªŒçš„ä¹Ÿæ˜¯bindingResult ~~~~</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initDirectFieldAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>bindingResult <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;DataBinder is already initialized - call initDirectFieldAccess before other configuration methods&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>bindingResult <span class="token operator">=</span> <span class="token function">createDirectFieldBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">protected</span> <span class="token class-name">AbstractPropertyBindingResult</span> <span class="token function">createDirectFieldBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">DirectFieldBindingResult</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DirectFieldBindingResult</span><span class="token punctuation">(</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getObjectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">isAutoGrowNestedPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>conversionService <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			result<span class="token punctuation">.</span><span class="token function">initConversion</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>conversionService<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>messageCodesResolver <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			result<span class="token punctuation">.</span><span class="token function">setMessageCodesResolver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>messageCodesResolver<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> result<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token comment">// æŠŠå±æ€§è®¿é—®å™¨è¿”å›ï¼ŒPropertyAccessor(é»˜è®¤ç›´æ¥ä»ç»“æœé‡Œæ‹¿)ï¼Œå­ç±»MapDataBinderæœ‰å¤å†™</span>
	<span class="token keyword">protected</span> <span class="token class-name">ConfigurablePropertyAccessor</span> <span class="token function">getPropertyAccessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">getInternalBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPropertyAccessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// å¯ä»¥çœ‹åˆ°ç®€å•çš„è½¬æ¢å™¨ä¹Ÿæ˜¯ä½¿ç”¨åˆ°äº†conversionServiceçš„ï¼Œå¯è§conversionServiceå®ƒçš„æ•ˆç”¨</span>
	<span class="token keyword">protected</span> <span class="token class-name">SimpleTypeConverter</span> <span class="token function">getSimpleTypeConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>typeConverter <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>typeConverter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleTypeConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>conversionService <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>typeConverter<span class="token punctuation">.</span><span class="token function">setConversionService</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>conversionService<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>typeConverter<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">// çœç•¥ä¼—å¤šgetæ–¹æ³•</span>
	
	<span class="token comment">// è®¾ç½®æŒ‡å®šçš„å¯ä»¥ç»‘å®šçš„å­—æ®µï¼Œé»˜è®¤æ˜¯æ‰€æœ‰å­—æ®µ~~~</span>
	<span class="token comment">// ä¾‹å¦‚ï¼Œåœ¨ç»‘å®šHTTPè¯·æ±‚å‚æ•°æ—¶ï¼Œé™åˆ¶è¿™ä¸€ç‚¹ä»¥é¿å…æ¶æ„ç”¨æˆ·è¿›è¡Œä¸å¿…è¦çš„ä¿®æ”¹ã€‚</span>
	<span class="token comment">// ç®€å•çš„è¯´ï¼šæˆ‘å¯ä»¥æ§åˆ¶åªæœ‰æŒ‡å®šçš„ä¸€äº›å±æ€§æ‰å…è®¸ä½ ä¿®æ”¹~~~~</span>
	<span class="token comment">// æ³¨æ„ï¼šå®ƒæ”¯æŒxxx*,*xxx,*xxx*è¿™æ ·çš„é€šé…ç¬¦  æ”¯æŒ[]è¿™æ ·å­æ¥å†™~</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAllowedFields</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> allowedFields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>allowedFields <span class="token operator">=</span> <span class="token class-name">PropertyAccessorUtils</span><span class="token punctuation">.</span><span class="token function">canonicalPropertyNames</span><span class="token punctuation">(</span>allowedFields<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDisallowedFields</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> disallowedFields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>disallowedFields <span class="token operator">=</span> <span class="token class-name">PropertyAccessorUtils</span><span class="token punctuation">.</span><span class="token function">canonicalPropertyNames</span><span class="token punctuation">(</span>disallowedFields<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// æ³¨å†Œæ¯ä¸ªç»‘å®šè¿›ç¨‹æ‰€å¿…é¡»çš„å­—æ®µã€‚</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRequiredFields</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> requiredFields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>requiredFields <span class="token operator">=</span> <span class="token class-name">PropertyAccessorUtils</span><span class="token punctuation">.</span><span class="token function">canonicalPropertyNames</span><span class="token punctuation">(</span>requiredFields<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;DataBinder requires binding of required fields [&quot;</span> <span class="token operator">+</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">arrayToCommaDelimitedString</span><span class="token punctuation">(</span>requiredFields<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token comment">// æ³¨æ„ï¼šè¿™ä¸ªæ˜¯setæ–¹æ³•ï¼Œåé¢æ˜¯æœ‰addæ–¹æ³•çš„~</span>
	<span class="token comment">// æ³¨æ„ï¼šè™½ç„¶æ˜¯setï¼Œä½†æ˜¯å¼•ç”¨æ˜¯æœ¨æœ‰å˜çš„~~~~</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setValidator</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Validator</span> validator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// åˆ¤æ–­é€»è¾‘åœ¨ä¸‹é¢ï¼šä½ çš„validatorè‡³å°‘å¾—æ”¯æŒè¿™ç§ç±»å‹å‘€  å“ˆå“ˆ</span>
		<span class="token function">assertValidators</span><span class="token punctuation">(</span>validator<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// å› ä¸ºè‡ªå·±æ‰‹åŠ¨è®¾ç½®äº†ï¼Œæ‰€ä»¥å…ˆæ¸…ç©º  å†åŠ è¿›æ¥~~~</span>
		<span class="token comment">// è¿™æ­¥ä½ ä¼šå‘ç°ï¼Œå³ä½¿validatoræ˜¯nullï¼Œä¹Ÿæ˜¯ä¼šclearçš„å“¦~  ç¬¦åˆè¯­æ„</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>validators<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>validator <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>validators<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>validator<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">assertValidators</span><span class="token punctuation">(</span><span class="token class-name">Validator</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> validators<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Object</span> target <span class="token operator">=</span> <span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Validator</span> validator <span class="token operator">:</span> validators<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>validator <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>target <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>validator<span class="token punctuation">.</span><span class="token function">supports</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;Invalid target for Validator [&quot;</span> <span class="token operator">+</span> validator <span class="token operator">+</span> <span class="token string">&quot;]: &quot;</span> <span class="token operator">+</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addValidators</span><span class="token punctuation">(</span><span class="token class-name">Validator</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> validators<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">assertValidators</span><span class="token punctuation">(</span>validators<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>validators<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>validators<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// æ•ˆæœåŒset</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">replaceValidators</span><span class="token punctuation">(</span><span class="token class-name">Validator</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> validators<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">assertValidators</span><span class="token punctuation">(</span>validators<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>validators<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>validators<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>validators<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// è¿”å›ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯primaryé»˜è®¤çš„æ ¡éªŒå™¨</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">public</span> <span class="token class-name">Validator</span> <span class="token function">getValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>validators<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>validators<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// åªè¯»è§†å›¾</span>
	<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Validator</span><span class="token punctuation">&gt;</span></span> <span class="token function">getValidators</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">unmodifiableList</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>validators<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// since Spring 3.0</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setConversionService</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ConversionService</span> conversionService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>conversionService <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;DataBinder is already initialized with ConversionService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>conversionService <span class="token operator">=</span> conversionService<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>bindingResult <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> conversionService <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>bindingResult<span class="token punctuation">.</span><span class="token function">initConversion</span><span class="token punctuation">(</span>conversionService<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// =============ä¸‹é¢å®ƒæä¾›äº†éå¸¸å¤šçš„addCustomFormatter()æ–¹æ³•  æ³¨å†Œè¿›PropertyEditorRegistryé‡Œ=====================</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addCustomFormatter</span><span class="token punctuation">(</span><span class="token class-name">Formatter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> formatter<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addCustomFormatter</span><span class="token punctuation">(</span><span class="token class-name">Formatter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> formatter<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> fields<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addCustomFormatter</span><span class="token punctuation">(</span><span class="token class-name">Formatter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> formatter<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> fieldTypes<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// å®ç°æ¥å£æ–¹æ³•</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerCustomEditor</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> requiredType<span class="token punctuation">,</span> <span class="token class-name">PropertyEditor</span> propertyEditor<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerCustomEditor</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> requiredType<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> field<span class="token punctuation">,</span> <span class="token class-name">PropertyEditor</span> propertyEditor<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token comment">// å®ç°æ¥å£æ–¹æ³•</span>
	<span class="token comment">// ç»Ÿä¸€å§”æ‰˜ç»™æŒæœ‰çš„TypeConverter~~æˆ–è€…æ˜¯getInternalBindingResult().getPropertyAccessor();è¿™é‡Œé¢çš„</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token annotation punctuation">@Nullable</span>
	<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">convertIfNecessary</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> requiredType<span class="token punctuation">,</span>
			<span class="token annotation punctuation">@Nullable</span> <span class="token class-name">MethodParameter</span> methodParam<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TypeMismatchException</span> <span class="token punctuation">{</span>

		<span class="token keyword">return</span> <span class="token function">getTypeConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">convertIfNecessary</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> requiredType<span class="token punctuation">,</span> methodParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	<span class="token comment">// ===========ä¸Šé¢çš„æ–¹æ³•éƒ½æ˜¯å¼€èƒƒå°èœï¼Œä¸‹é¢æ‰æ˜¯æœ¬ç±»æœ€é‡è¦çš„æ–¹æ³•==============</span>

	<span class="token comment">// è¯¥æ–¹æ³•å°±æ˜¯æŠŠæä¾›çš„å±æ€§å€¼ä»¬ï¼Œç»‘å®šåˆ°ç›®æ ‡å¯¹è±¡targeté‡Œå»~~~</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token class-name">PropertyValues</span> pvs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">MutablePropertyValues</span> mpvs <span class="token operator">=</span> <span class="token punctuation">(</span>pvs <span class="token keyword">instanceof</span> <span class="token class-name">MutablePropertyValues</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token class-name">MutablePropertyValues</span><span class="token punctuation">)</span> pvs <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">MutablePropertyValues</span><span class="token punctuation">(</span>pvs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">doBind</span><span class="token punctuation">(</span>mpvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// æ­¤æ–¹æ³•æ˜¯protectedçš„ï¼Œå­ç±»WebDataBinderæœ‰å¤å†™~~~åŠ å¼ºäº†ä¸€ä¸‹</span>
	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doBind</span><span class="token punctuation">(</span><span class="token class-name">MutablePropertyValues</span> mpvs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// å‰é¢ä¸¤ä¸ªcheckå°±ä¸è§£é‡Šäº†ï¼Œé‡ç‚¹çœ‹çœ‹applyPropertyValues(mpvs)è¿™ä¸ªæ–¹æ³•~</span>
		<span class="token function">checkAllowedFields</span><span class="token punctuation">(</span>mpvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">checkRequiredFields</span><span class="token punctuation">(</span>mpvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">applyPropertyValues</span><span class="token punctuation">(</span>mpvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// alloweå…è®¸çš„ å¹¶ä¸”è¿˜æ˜¯æ²¡æœ‰åœ¨disallowedé‡Œé¢çš„ è¿™ä¸ªå­—æ®µå°±æ˜¯è¢«å…è®¸çš„</span>
	<span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">isAllowed</span><span class="token punctuation">(</span><span class="token class-name">String</span> field<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> allowed <span class="token operator">=</span> <span class="token function">getAllowedFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> disallowed <span class="token operator">=</span> <span class="token function">getDisallowedFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>allowed<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">PatternMatchUtils</span><span class="token punctuation">.</span><span class="token function">simpleMatch</span><span class="token punctuation">(</span>allowed<span class="token punctuation">,</span> field<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
				<span class="token punctuation">(</span><span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>disallowed<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token class-name">PatternMatchUtils</span><span class="token punctuation">.</span><span class="token function">simpleMatch</span><span class="token punctuation">(</span>disallowed<span class="token punctuation">,</span> field<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token comment">// protected æ–¹æ³•ï¼Œç»™targetèµ‹å€¼~~~~</span>
	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">applyPropertyValues</span><span class="token punctuation">(</span><span class="token class-name">MutablePropertyValues</span> mpvs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token comment">// å¯ä»¥çœ‹åˆ°æœ€ç»ˆèµ‹å€¼ æ˜¯å§”æ‰˜ç»™PropertyAccessorå»å®Œæˆçš„</span>
			<span class="token function">getPropertyAccessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setPropertyValues</span><span class="token punctuation">(</span>mpvs<span class="token punctuation">,</span> <span class="token function">isIgnoreUnknownFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">isIgnoreInvalidFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// æŠ›å‡ºå¼‚å¸¸ï¼Œäº¤ç»™BindingErrorProcessorä¸€ä¸ªä¸ªå¤„ç†~~~</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">PropertyBatchUpdateException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PropertyAccessException</span> pae <span class="token operator">:</span> ex<span class="token punctuation">.</span><span class="token function">getPropertyAccessExceptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">getBindingErrorProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">processPropertyAccessException</span><span class="token punctuation">(</span>pae<span class="token punctuation">,</span> <span class="token function">getInternalBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// æ‰§è¡Œæ ¡éªŒï¼Œæ­¤å¤„å°±å’ŒBindingResult å…³è”ä¸Šäº†ï¼Œæ ¡éªŒå¤±è´¥çš„æ¶ˆæ¯éƒ½ä¼šæ”¾è¿›å»ï¼ˆä¸æ˜¯ç›´æ¥æŠ›å‡ºå¼‚å¸¸å“¦~ ï¼‰</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Object</span> target <span class="token operator">=</span> <span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">state</span><span class="token punctuation">(</span>target <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;No target to validate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">BindingResult</span> bindingResult <span class="token operator">=</span> <span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// æ¯ä¸ªValidatoréƒ½ä¼šæ‰§è¡Œ~~~~</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Validator</span> validator <span class="token operator">:</span> <span class="token function">getValidators</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			validator<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> bindingResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// å¸¦æœ‰æ ¡éªŒæç¤ºçš„æ ¡éªŒå™¨ã€‚SmartValidator</span>
	<span class="token comment">// @since 3.1</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> validationHints<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

	<span class="token comment">// è¿™ä¸€æ­¥ä¹ŸæŒºæœ‰æ„æ€ï¼šå®é™…ä¸Šå°±æ˜¯è‹¥æœ‰é”™è¯¯ï¼Œå°±æŠ›å‡ºå¼‚å¸¸</span>
	<span class="token comment">// è‹¥æ²¡é”™è¯¯  å°±æŠŠç»‘å®šçš„Modelè¿”å›~~~(å¯ä»¥çœ‹åˆ°BindingResulté‡Œä¹Ÿèƒ½æ‹¿åˆ°æœ€ç»ˆå€¼å“¦~~~)</span>
	<span class="token comment">// æ­¤æ–¹æ³•å¯ä»¥è°ƒç”¨ï¼Œä½†ä¸€èˆ¬è¾ƒå°‘ä½¿ç”¨~</span>
	<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BindException</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BindException</span><span class="token punctuation">(</span><span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token function">getBindingResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ å®ƒæ˜¯ä¸ª<strong>å®ç°ç±»</strong>ï¼Œç›´æ¥å®ç°äº†<code>PropertyEditorRegistry</code>å’Œ<code>TypeConverter</code>è¿™ä¸¤ä¸ªæ¥å£ï¼Œå› æ­¤å®ƒå¯ä»¥æ³¨å†Œ<code>java.beans.PropertyEditor</code>ï¼Œå¹¶ä¸”èƒ½å®Œæˆç±»å‹è½¬æ¢ï¼ˆ<code>TypeConverter</code>ï¼‰ã€‚</p><p>å®ƒæä¾›äº†å¦‚ä¸‹èƒ½åŠ›ï¼š</p><ol><li>æŠŠå±æ€§å€¼<code>PropertyValues</code>ç»‘å®šåˆ°targetä¸Šï¼ˆ<code>bind()</code>æ–¹æ³•ï¼Œä¾èµ–äº<code>PropertyAccessor</code>å®ç°~ï¼‰</li><li>æä¾›æ ¡éªŒçš„èƒ½åŠ›ï¼šæä¾›äº†publicæ–¹æ³•<code>validate()</code>å¯¹å„ä¸ªå±æ€§ä½¿ç”¨<code>Validator</code>æ‰§è¡Œæ ¡éªŒ~</li><li>æä¾›äº†æ³¨å†Œå±æ€§ç¼–è¾‘å™¨ï¼ˆ<code>PropertyEditor</code>ï¼‰å’Œå¯¹ç±»å‹è¿›è¡Œè½¬æ¢çš„èƒ½åŠ›ï¼ˆ<code>TypeConverter</code>ï¼‰</li></ol><p>è¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p><ol><li><code>initBeanPropertyAccess</code>å’Œ<code>initDirectFieldAccess</code>ä¸¤ä¸ªåˆå§‹åŒ–<code>PropertyAccessor</code>æ–¹æ³•æ˜¯äº’æ–¥çš„ <ul><li><code>initBeanPropertyAccess()</code>åˆ›å»ºçš„æ˜¯<code>BeanPropertyBindingResult</code>ï¼Œå†…éƒ¨ä¾èµ–<code>BeanWrapper</code></li><li><code>initDirectFieldAccess</code>åˆ›å»ºçš„æ˜¯<code>DirectFieldBindingResult</code>ï¼Œå†…éƒ¨ä¾èµ–<code>DirectFieldAccessor</code></li></ul></li><li>è¿™ä¸¤ä¸ªæ–¹æ³•å†…éƒ¨æ²¡æœ‰æ˜¾ç¤ºçš„è°ƒç”¨ï¼Œä½†æ˜¯Springå†…éƒ¨<strong>é»˜è®¤</strong>ä½¿ç”¨çš„æ˜¯<code>initBeanPropertyAccess()</code>ï¼Œå…·ä½“å¯ä»¥å‚ç…§<code>getInternalBindingResult()</code>æ–¹æ³•~</li></ol><hr><h4 id="webdatabinder" tabindex="-1"><a class="header-anchor" href="#webdatabinder" aria-hidden="true">#</a> WebDataBinder</h4><hr><h2 id="æ•°æ®æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#æ•°æ®æ ¡éªŒ" aria-hidden="true">#</a> æ•°æ®æ ¡éªŒ</h2><h3 id="å¸¸ç”¨æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#å¸¸ç”¨æ³¨è§£" aria-hidden="true">#</a> å¸¸ç”¨æ³¨è§£</h3><h4 id="jsr303" tabindex="-1"><a class="header-anchor" href="#jsr303" aria-hidden="true">#</a> JSR303</h4><table><thead><tr><th style="text-align:left;">æ³¨è§£</th><th style="text-align:left;">æ”¯æŒç±»å‹</th><th style="text-align:left;">å«ä¹‰</th><th style="text-align:left;">nullå€¼æ˜¯å¦æ ¡éªŒ</th></tr></thead><tbody><tr><td style="text-align:left;">@AssertFalse</td><td style="text-align:left;">bool</td><td style="text-align:left;">å…ƒç´ å¿…é¡»æ˜¯false</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@AssertTrue</td><td style="text-align:left;">bool</td><td style="text-align:left;">å…ƒç´ å¿…é¡»æ˜¯true</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@DecimalMax</td><td style="text-align:left;">Numberçš„å­ç±»å‹ï¼ˆæµ®ç‚¹æ•°é™¤å¤–ï¼‰ä»¥åŠString</td><td style="text-align:left;">å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä¸”å€¼å¿…é¡»&lt;=æœ€å¤§å€¼</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@DecimalMin</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä¸”å€¼å¿…é¡»&gt;=æœ€å¤§å€¼</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@Max</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@Min</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@Digits</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">å…ƒç´ æ„æˆæ˜¯å¦åˆæ³•ï¼ˆæ•´æ•°éƒ¨åˆ†å’Œå°æ•°éƒ¨åˆ†ï¼‰</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@Future</td><td style="text-align:left;">æ—¶é—´ç±»å‹(åŒ…æ‹¬JSR310)</td><td style="text-align:left;">å…ƒç´ å¿…é¡»ä¸ºä¸€ä¸ªå°†æ¥ï¼ˆä¸åŒ…å«ç›¸ç­‰ï¼‰çš„æ—¥æœŸ(æ¯”è¾ƒç²¾ç¡®åˆ°æ¯«ç§’)</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@Past</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">å…ƒç´ å¿…é¡»ä¸ºä¸€ä¸ªè¿‡å»ï¼ˆä¸åŒ…å«ç›¸ç­‰ï¼‰çš„æ—¥æœŸ(æ¯”è¾ƒç²¾ç¡®åˆ°æ¯«ç§’)</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@NotNull</td><td style="text-align:left;">any</td><td style="text-align:left;">å…ƒç´ ä¸èƒ½ä¸ºnull</td><td style="text-align:left;">æ˜¯</td></tr><tr><td style="text-align:left;">@Null</td><td style="text-align:left;">any</td><td style="text-align:left;">å…ƒç´ å¿…é¡»ä¸ºnull</td><td style="text-align:left;">æ˜¯</td></tr><tr><td style="text-align:left;">@Pattern</td><td style="text-align:left;">å­—ç¬¦ä¸²</td><td style="text-align:left;">å…ƒç´ éœ€ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@Size</td><td style="text-align:left;">String/Collection/Map/Array</td><td style="text-align:left;">å…ƒç´ å¤§å°éœ€åœ¨æŒ‡å®šèŒƒå›´ä¸­</td><td style="text-align:left;">å¦</td></tr></tbody></table><h4 id="jsr380" tabindex="-1"><a class="header-anchor" href="#jsr380" aria-hidden="true">#</a> JSR380</h4><table><thead><tr><th style="text-align:left;">æ³¨è§£</th><th style="text-align:left;">æ”¯æŒç±»å‹</th><th style="text-align:left;">å«ä¹‰</th><th style="text-align:left;">nullå€¼æ˜¯å¦æ ¡éªŒ</th></tr></thead><tbody><tr><td style="text-align:left;">@Email</td><td style="text-align:left;">å­—ç¬¦ä¸²</td><td style="text-align:left;">å…ƒç´ å¿…é¡»ä¸ºç”µå­é‚®ç®±åœ°å€</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@NotEmpty</td><td style="text-align:left;">å®¹å™¨ç±»å‹</td><td style="text-align:left;">é›†åˆçš„Sizeå¿…é¡»å¤§äº0</td><td style="text-align:left;">æ˜¯</td></tr><tr><td style="text-align:left;">@NotBlank</td><td style="text-align:left;">å­—ç¬¦ä¸²</td><td style="text-align:left;">å­—ç¬¦ä¸²å¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªéç©ºç™½çš„å­—ç¬¦</td><td style="text-align:left;">æ˜¯</td></tr><tr><td style="text-align:left;">@Positive</td><td style="text-align:left;">æ•°å­—ç±»å‹</td><td style="text-align:left;">å…ƒç´ å¿…é¡»ä¸ºæ­£æ•°ï¼ˆä¸åŒ…æ‹¬0ï¼‰</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@PositiveOrZero</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">åŒä¸Šï¼ˆåŒ…æ‹¬0ï¼‰</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@Negative</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">å…ƒç´ å¿…é¡»ä¸ºè´Ÿæ•°ï¼ˆä¸åŒ…æ‹¬0ï¼‰</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@NegativeOrZero</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">åŒä¸Šï¼ˆåŒ…æ‹¬0ï¼‰</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@PastOrPresent</td><td style="text-align:left;">æ—¶é—´ç±»å‹</td><td style="text-align:left;">åœ¨@PaståŸºç¡€ä¸ŠåŒ…æ‹¬ç›¸ç­‰</td><td style="text-align:left;">å¦</td></tr><tr><td style="text-align:left;">@FutureOrPresent</td><td style="text-align:left;">æ—¶é—´ç±»å‹</td><td style="text-align:left;">åœ¨@FutrueåŸºç¡€ä¸ŠåŒ…æ‹¬ç›¸ç­‰</td><td style="text-align:left;">å¦</td></tr></tbody></table><h4 id="hibernate" tabindex="-1"><a class="header-anchor" href="#hibernate" aria-hidden="true">#</a> Hibernate</h4><table><thead><tr><th style="text-align:left;">çº¦æŸæ³¨è§£</th><th style="text-align:left;">æ”¯æŒçš„ç±»å‹</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;">@URL</td><td style="text-align:left;">CharSequence</td><td style="text-align:left;">æ ¡éªŒURLã€‚protocol=&quot;&quot;,host=&quot;&quot;, port=&quot;&quot;, regexp=&quot;.*&quot;, flags={}</td></tr><tr><td style="text-align:left;">@UniqueElements</td><td style="text-align:left;">Collection</td><td style="text-align:left;">é›†åˆå†…ä¸å…è®¸æœ‰é‡å¤å…ƒç´ ã€‚</td></tr><tr><td style="text-align:left;">@SafeHtml</td><td style="text-align:left;">CharSequence</td><td style="text-align:left;">ä¼ å…¥çš„æ–‡æœ¬ä¸­ä¸èƒ½å«æœ‰scriptç­‰æ•æ„Ÿæ ‡ç­¾ã€‚ï¼ˆæ³¨æ„ï¼šéœ€è¦org.jsoupåŒ…çš„æ”¯æŒï¼‰</td></tr><tr><td style="text-align:left;">@Range</td><td style="text-align:left;">åŒ@Min</td><td style="text-align:left;">æ˜¯å¯¹@Minå’Œ@Maxçš„ç»“åˆè¡¥å……</td></tr><tr><td style="text-align:left;">@Length</td><td style="text-align:left;">CharSequence</td><td style="text-align:left;">value.length() &gt;= min &amp;&amp; value.length() &lt;= maxï¼ˆnull is validï¼‰</td></tr><tr><td style="text-align:left;">@ISBN</td><td style="text-align:left;">CharSequence</td><td style="text-align:left;">æ ¡éªŒå›¾ä¹¦çš„ISBNã€‚typeï¼šType.ISBN_13ï¼ˆè¿˜æœ‰ä¸ªå–å€¼ï¼šISBN_10ï¼‰</td></tr><tr><td style="text-align:left;">@EAN</td><td style="text-align:left;">CharSequence</td><td style="text-align:left;">æ ¡éªŒå•†ç”¨æ¡å½¢ç EAN</td></tr><tr><td style="text-align:left;">@Currency</td><td style="text-align:left;">MonetaryAmount</td><td style="text-align:left;">æ ¡éªŒè´§å¸ã€‚valueï¼šåªå…è®¸çš„è´§å¸ç§ç±»ï¼Œå¦‚USD, EURç­‰</td></tr><tr><td style="text-align:left;">@CodePointLength</td><td style="text-align:left;">CharSequence</td><td style="text-align:left;">æ ¡éªŒä»£ç ç‚¹codePointã€‚å…³äºStringçš„lengthå’Œä»£ç ç‚¹ï¼Œå¯å‚è€ƒè¿™é‡Œ ä¸€èˆ¬ä¸ä½¿ç”¨ï¼Œä½¿ç”¨@Lengthå³å¯~</td></tr><tr><td style="text-align:left;">@ConstraintComposition</td><td style="text-align:left;">all</td><td style="text-align:left;">æ‰€æœ‰çº¦æŸæ˜¯AND/OR/ALL_FALSEå…³ç³»ã€‚å®ƒåªèƒ½æ ‡æ³¨åœ¨æ³¨è§£ä¸Šï¼Œè¿ç”¨äºç»„åˆæ³¨è§£ä¸Š</td></tr><tr><td style="text-align:left;">@DurationMax</td><td style="text-align:left;">Duration</td><td style="text-align:left;">maxDuration.compareTo( value )è¿™ä¹ˆæ¯”è¾ƒçš„ï¼Œç›¸ç­‰ä¹Ÿæ˜¯validçš„</td></tr><tr><td style="text-align:left;">@DurationMin</td><td style="text-align:left;">Duration</td><td style="text-align:left;">`minDuration.compareTo( value )è¿™ä¹ˆæ¯”è¾ƒçš„ï¼Œç›¸ç­‰ä¹Ÿæ˜¯validçš„</td></tr><tr><td style="text-align:left;">@CNPJ</td><td style="text-align:left;">CharSequence</td><td style="text-align:left;">æ³•äººå›½å®¶ç™»è®°å·</td></tr><tr><td style="text-align:left;">@ReportAsSingleViolation</td><td style="text-align:left;">*</td><td style="text-align:left;">å¦‚æœ<code>@NotEmpty</code>ã€<code>@Pattern</code>éƒ½æ ¡éªŒå¤±è´¥ï¼Œä¸æ·»åŠ æ­¤æ³¨è§£ï¼Œåˆ™ä¼šç”Ÿæˆ<strong>ä¸¤ä¸ª</strong>æ ¡éªŒå¤±è´¥çš„ç»“æœã€‚è‹¥æ·»åŠ äº†æ­¤æ³¨è§£ï¼Œé‚£é”™è¯¯æ¶ˆæ¯ä»¥å®ƒæ ‡æ³¨çš„æœ¬æ³¨è§£çš„<code>message</code>ä¸ºå‡†</td></tr></tbody></table><h3 id="validatedå’Œ-validçš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#validatedå’Œ-validçš„åŒºåˆ«" aria-hidden="true">#</a> @Validatedå’Œ@Validçš„åŒºåˆ«</h3><ol><li><code>@Valid</code>ï¼šæ ‡å‡†JSR-303è§„èŒƒçš„æ ‡è®°å‹æ³¨è§£ï¼Œç”¨æ¥æ ‡è®°éªŒè¯å±æ€§å’Œæ–¹æ³•è¿”å›å€¼ï¼Œè¿›è¡Œ<strong>çº§è”å’Œé€’å½’æ ¡éªŒ</strong></li><li><code>@Validated</code>ï¼š<code>Spring</code>çš„æ³¨è§£ï¼Œæ˜¯æ ‡å‡†<code>JSR-303</code>çš„ä¸€ä¸ªå˜ç§ï¼ˆè¡¥å……ï¼‰ï¼Œæä¾›äº†ä¸€ä¸ª<strong>åˆ†ç»„</strong>åŠŸèƒ½ï¼Œå¯ä»¥åœ¨å…¥å‚éªŒè¯æ—¶ï¼Œæ ¹æ®ä¸åŒçš„åˆ†ç»„é‡‡ç”¨ä¸åŒçš„éªŒè¯æœºåˆ¶</li><li>åœ¨<code>Controller</code>ä¸­æ ¡éªŒæ–¹æ³•å‚æ•°æ—¶ï¼Œä½¿ç”¨@Validå’Œ@Validatedå¹¶æ— ç‰¹æ®Šå·®å¼‚ï¼ˆè‹¥ä¸éœ€è¦åˆ†ç»„æ ¡éªŒçš„è¯ï¼‰</li><li><code>@Validated</code>æ³¨è§£å¯ä»¥ç”¨äºç±»çº§åˆ«ï¼Œç”¨äºæ”¯æŒSpringè¿›è¡Œæ–¹æ³•çº§åˆ«çš„å‚æ•°æ ¡éªŒã€‚<code>@Valid</code>å¯ä»¥ç”¨åœ¨å±æ€§çº§åˆ«çº¦æŸï¼Œç”¨æ¥è¡¨ç¤º<strong>çº§è”æ ¡éªŒ</strong>ã€‚</li><li><code>@Validated</code>åªèƒ½ç”¨åœ¨ç±»ã€æ–¹æ³•å’Œå‚æ•°ä¸Šï¼Œè€Œ<code>@Valid</code>å¯ç”¨äºæ–¹æ³•ã€<strong>å­—æ®µã€æ„é€ å™¨</strong>å’Œå‚æ•°ä¸Š</li></ol><h3 id="åˆ†ç»„æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#åˆ†ç»„æ ¡éªŒ" aria-hidden="true">#</a> åˆ†ç»„æ ¡éªŒ</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// è¯¥æ¥å£å®šä¹‰äº†ï¼šåŠ¨æ€Groupåºåˆ—çš„åå®š</span>
<span class="token comment">// è¦æƒ³å®ƒç”Ÿæ•ˆï¼Œéœ€è¦åœ¨Tä¸Šæ ‡æ³¨@GroupSequenceProvideræ³¨è§£å¹¶ä¸”æŒ‡å®šæ­¤ç±»ä¸ºå¤„ç†ç±»</span>
<span class="token comment">// å¦‚æœ`Default`ç»„å¯¹Tè¿›è¡ŒéªŒè¯ï¼Œåˆ™å®é™…éªŒè¯çš„å®ä¾‹å°†ä¼ é€’ç»™æ­¤ç±»ä»¥ç¡®å®šé»˜è®¤ç»„åºåˆ—ï¼ˆè¿™å¥è¯ç‰¹åˆ«é‡è¦  ä¸‹é¢ç”¨ä¾‹å­è§£é‡Šï¼‰</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DefaultGroupSequenceProvider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token comment">// åˆæ ¼æ–¹æ³•æ˜¯ç»™Tè¿”å›é»˜è®¤çš„ç»„ï¼ˆå¤šä¸ªï¼‰ã€‚å› ä¸ºé»˜è®¤çš„ç»„æ˜¯Defaultå˜›~~~é€šè¿‡å®ƒå¯ä»¥è‡ªå®šæŒ‡å®š</span>
	<span class="token comment">// å…¥å‚T objectå…è®¸åœ¨éªŒè¯å€¼çŠ¶æ€çš„å‡½æ•°ä¸­åŠ¨æ€ç»„åˆé»˜è®¤ç»„åºåˆ—ã€‚ï¼ˆéå¸¸å¼ºå¤§ï¼‰</span>
	<span class="token comment">// objectæ˜¯å¾…æ ¡éªŒçš„Beanã€‚å®ƒå¯ä»¥ä¸ºnullå“¦~ï¼ˆValidator#validateValueçš„æ—¶å€™å¯ä»¥ä¸ºnullï¼‰</span>

	<span class="token comment">// è¿”å›å€¼è¡¨ç¤ºé»˜è®¤ç»„åºåˆ—çš„Listã€‚å®ƒçš„æ•ˆæœåŒ@GroupSequenceå®šä¹‰ç»„åºåˆ—ï¼Œå°¤å…¶æ˜¯åˆ—è¡¨Listå¿…é¡»åŒ…å«ç±»å‹T</span>
	<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getValidationGroups</span><span class="token punctuation">(</span><span class="token class-name">T</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GroupSequenceProvider</span><span class="token punctuation">(</span><span class="token class-name">PersonGroupSequenceProvider</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@ToString</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@NotNull</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NotNull</span>
    <span class="token annotation punctuation">@Range</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">WhenAge20And30Group</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">WhenAge30And40Group</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token class-name">WhenAge20And30Group</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token class-name">WhenAge30And40Group</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> hobbies<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * å®šä¹‰ä¸“å±çš„ä¸šåŠ¡é€»è¾‘åˆ†ç»„
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">WhenAge20And30Group</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">WhenAge30And40Group</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PersonGroupSequenceProvider</span> <span class="token keyword">implements</span> <span class="token class-name">DefaultGroupSequenceProvider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getValidationGroups</span><span class="token punctuation">(</span><span class="token class-name">Person</span> bean<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> defaultGroupSequence <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        defaultGroupSequence<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿™ä¸€æ­¥ä¸èƒ½çœ,å¦åˆ™Defaultåˆ†ç»„éƒ½ä¸ä¼šæ‰§è¡Œäº†ï¼Œä¼šæŠ›é”™çš„</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// è¿™å—åˆ¤ç©ºè¯·åŠ¡å¿…è¦åš</span>
            <span class="token class-name">Integer</span> age <span class="token operator">=</span> bean<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¹´é¾„ä¸ºï¼š&quot;</span> <span class="token operator">+</span> age <span class="token operator">+</span> <span class="token string">&quot;ï¼Œæ‰§è¡Œå¯¹åº”æ ¡éªŒé€»è¾‘&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>age <span class="token operator">&gt;=</span> <span class="token number">20</span> <span class="token operator">&amp;&amp;</span> age <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                defaultGroupSequence<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Person<span class="token punctuation">.</span>WhenAge20And30Group</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>age <span class="token operator">&gt;=</span> <span class="token number">30</span> <span class="token operator">&amp;&amp;</span> age <span class="token operator">&lt;</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                defaultGroupSequence<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Person<span class="token punctuation">.</span>WhenAge30And40Group</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> defaultGroupSequence<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>  <span class="token punctuation">{</span>
    <span class="token class-name">Person</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    person<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;fsx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    person<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		person<span class="token punctuation">.</span><span class="token function">setHobbies</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;è¶³çƒ&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ç¯®çƒ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConstraintViolation</span><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token class-name">Validation</span><span class="token punctuation">.</span><span class="token function">buildDefaultValidatorFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å¯¹ç»“æœè¿›è¡Œéå†è¾“å‡º</span>
    result<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>v <span class="token operator">-&gt;</span> v<span class="token punctuation">.</span><span class="token function">getPropertyPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> v<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> v<span class="token punctuation">.</span><span class="token function">getInvalidValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="spel" tabindex="-1"><a class="header-anchor" href="#spel" aria-hidden="true">#</a> SpEL</h2><ul><li><p>SpEL å­—é¢é‡</p><ul><li>æ•´æ•°ï¼š<code>#{8} </code></li><li>å°æ•°ï¼š<code>#{8.8} </code></li><li>ç§‘å­¦è®¡æ•°æ³•ï¼š<code>#{1e4} </code></li><li>Stringï¼šå¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·ä½œä¸ºå­—ç¬¦ä¸²çš„å®šç•Œç¬¦å·ã€‚</li><li>Booleanï¼š<code>#{true}</code></li></ul></li><li><p>SpELå¼•ç”¨bean , å±æ€§å’Œæ–¹æ³•</p><ul><li>å¼•ç”¨å…¶ä»–å¯¹è±¡: <code>#{car}</code></li><li>å¼•ç”¨å…¶ä»–å¯¹è±¡çš„å±æ€§ï¼š<code>#{car.brand} </code></li><li>è°ƒç”¨å…¶å®ƒæ–¹æ³• , è¿˜å¯ä»¥é“¾å¼æ“ä½œï¼š<code>#{car.toString()}</code></li><li>è°ƒç”¨é™æ€æ–¹æ³•é™æ€å±æ€§ï¼š<code>#{T(java.lang.Math).PI}</code></li></ul></li><li><p>SpELæ”¯æŒçš„è¿ç®—ç¬¦å·</p><ul><li>ç®—æœ¯è¿ç®—ç¬¦ï¼š+ï¼Œ-ï¼Œ*ï¼Œ/ï¼Œ%ï¼Œ^(åŠ å·è¿˜å¯ä»¥ç”¨ä½œå­—ç¬¦ä¸²è¿æ¥)</li><li>æ¯”è¾ƒè¿ç®—ç¬¦ï¼š&lt; , &gt; , == , &gt;= , &lt;= , lt , gt , eg , le , ge</li><li>é€»è¾‘è¿ç®—ç¬¦ï¼šand , or , not , | - if-else è¿ç®—ç¬¦(ç±»ä¼¼ä¸‰ç›®è¿ç®—ç¬¦)ï¼š<code>?:(temary)</code>, <code>?:(Elvis)</code></li><li>æ­£åˆ™è¡¨è¾¾å¼ï¼š<code>#{admin.email matches &#39;[a-zA-Z0-9._%Â±]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}&#39;}</code></li></ul></li><li><p>SpELè§£ææ–¹æ³•</p><ul><li>æ–¹æ³•å‚æ•°ï¼Œ<code>#userId</code>ï¼Œå‚æ•°å<code>userId</code>çš„å‚æ•°çš„å€¼</li><li>è¿”å›å€¼ï¼Œ<code>#$</code>æˆ–è€…<code>#result</code></li></ul></li><li><p>SpELå†…ç½®å¯¹è±¡</p><ul><li><code>#this</code>ï¼šå½“å‰å¯¹è±¡ï¼Œå¦‚æœåœ¨éå†åˆ—è¡¨ï¼Œå¯èƒ½ä¼šæ”¹å˜ä¸ºå…·ä½“çš„æ¯ä¸ªå…ƒç´ å¯¹è±¡</li><li><code>#root</code>ï¼šæ ¹å¯¹è±¡ï¼Œä¸ä¼šå› ä¸ºå½“å‰å…ƒç´ è½¬å˜è€Œè½¬å˜</li></ul></li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/nocetfy/edit/main/docs/interview/æ¡†æ¶/Spring æ‚é¡¹.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><!----><!----></div></footer><nav class="page-nav"><a href="/MyNotes/interview/%E6%A1%86%E6%9E%B6/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BB.html" class="nav-link prev" aria-label="å¸¸ç”¨å·¥å…·ç±»"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->å¸¸ç”¨å·¥å…·ç±»</div></a><!----></nav><!----><!----><!--]--></main><!--]--><!----></div><!--]--><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/MyNotes/assets/app-59c87434.js" defer></script>
    <script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-y/instant.page/5.1.0/instantpage.min.js" type="application/javascript"></script>
  </body>
</html>
